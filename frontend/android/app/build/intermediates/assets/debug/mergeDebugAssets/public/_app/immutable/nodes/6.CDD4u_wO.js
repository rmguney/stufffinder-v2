import{s as rt,e as C,c as I,b as $,f,C as u,i as E,x as lt,a as U,g as z,h as p,t as R,z as Q,d as Y,B as ie,A as X,q as oe,j as te,r as st,T as ke,X as Ce,y as fe,Y as Ie,E as nt,F as ae,n as me,k as Ve,Q as ht}from"../chunks/CEgPK7Kn.js";import{S as ot,i as at,c as q,a as G,m as J,t as B,b as P,d as K,g as ue,e as ce,f as je}from"../chunks/D5iEvBOg.js";import{C as ye,P as ne,e as de,u as it,o as ut,a as ct}from"../chunks/pqZsTTMp.js";import{T as ft,M as pt}from"../chunks/DG9Hls1a.js";import{a as _t}from"../chunks/uMXuyimC.js";import{C as De}from"../chunks/IxLpX9f4.js";import{P as gt}from"../chunks/DujqpIWG.js";import{a as dt}from"../chunks/zczyAANr.js";import{S as vt}from"../chunks/BNflJat_.js";import{g as $e}from"../chunks/RSIJn0f_.js";import{B as we}from"../chunks/dIJLHdEI.js";import{t as Be,u as wt}from"../chunks/CmYgl3nr.js";function bt({params:n}){return{id:n.id}}const Er=Object.freeze(Object.defineProperty({__proto__:null,load:bt},Symbol.toStringTag,{value:"Module"}));function Ue(n,e,t){const r=n.slice();return r[34]=e[t],r}function ze(n,e,t){const r=n.slice();return r[37]=e[t],r[39]=t,r}function Ee(n){const e=n.slice(),t=e[12][e[18]];return e[37]=t,e}function Se(n){let e,t="•",r,l,s=`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
              Best Answer`;return{c(){e=C("span"),e.textContent=t,r=U(),l=C("span"),l.innerHTML=s,this.h()},l(o){e=I(o,"SPAN",{"data-svelte-h":!0}),ie(e)!=="svelte-7hh8jk"&&(e.textContent=t),r=z(o),l=I(o,"SPAN",{class:!0,"data-svelte-h":!0}),ie(l)!=="svelte-zlbtxx"&&(l.innerHTML=s),this.h()},h(){u(l,"class","text-teal-800 dark:text-teal-600 font-medium flex items-center gap-1")},m(o,a){E(o,e,a),E(o,r,a),E(o,l,a)},d(o){o&&(f(e),f(r),f(l))}}}function Pe(n){let e,t,r,l,s,o=n[12].length>1&&Ne(n),a=n[12][n[18]]&&He(Ee(n)),i=n[12].length>1&&Le(n);return{c(){e=C("div"),t=C("div"),o&&o.c(),r=U(),l=C("div"),a&&a.c(),s=U(),i&&i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0});var h=$(e);t=I(h,"DIV",{class:!0});var v=$(t);o&&o.l(v),r=z(v),l=I(v,"DIV",{class:!0});var k=$(l);a&&a.l(k),k.forEach(f),v.forEach(f),s=z(h),i&&i.l(h),h.forEach(f),this.h()},h(){u(l,"class","w-full"),u(t,"class","relative"),u(e,"class","mt-4 bg-neutral-100 dark:bg-neutral-900 rounded-lg overflow-hidden")},m(c,h){E(c,e,h),p(e,t),o&&o.m(t,null),p(t,r),p(t,l),a&&a.m(l,null),p(e,s),i&&i.m(e,null)},p(c,h){c[12].length>1?o?o.p(c,h):(o=Ne(c),o.c(),o.m(t,r)):o&&(o.d(1),o=null),c[12][c[18]]?a?a.p(Ee(c),h):(a=He(Ee(c)),a.c(),a.m(l,null)):a&&(a.d(1),a=null),c[12].length>1?i?i.p(c,h):(i=Le(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(c){c&&f(e),o&&o.d(),a&&a.d(),i&&i.d()}}}function Ne(n){let e,t,r='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>',l,s,o,a='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>',i,c,h,v=n[18]+1+"",k,w,y=n[12].length+"",d,m,M;return{c(){e=C("div"),t=C("button"),t.innerHTML=r,l=U(),s=C("div"),o=C("button"),o.innerHTML=a,i=U(),c=C("div"),h=C("div"),k=R(v),w=R(" / "),d=R(y),this.h()},l(A){e=I(A,"DIV",{class:!0});var j=$(e);t=I(j,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ie(t)!=="svelte-1g17f84"&&(t.innerHTML=r),j.forEach(f),l=z(A),s=I(A,"DIV",{class:!0});var W=$(s);o=I(W,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ie(o)!=="svelte-fkqpxm"&&(o.innerHTML=a),W.forEach(f),i=z(A),c=I(A,"DIV",{class:!0});var O=$(c);h=I(O,"DIV",{class:!0});var _=$(h);k=Y(_,v),w=Y(_," / "),d=Y(_,y),_.forEach(f),O.forEach(f),this.h()},h(){u(t,"class","bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-1 rounded-r-lg ml-1 focus:outline-none transform transition hover:scale-110"),u(t,"aria-label","Previous media"),u(e,"class","absolute top-0 bottom-0 left-0 flex items-center z-10"),u(o,"class","bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-1 rounded-l-lg mr-1 focus:outline-none transform transition hover:scale-110"),u(o,"aria-label","Next media"),u(s,"class","absolute top-0 bottom-0 right-0 flex items-center z-10"),u(h,"class","bg-black bg-opacity-60 text-white px-2 py-0.5 rounded-full text-xs"),u(c,"class","absolute bottom-2 left-0 right-0 flex justify-center z-10")},m(A,j){E(A,e,j),p(e,t),E(A,l,j),E(A,s,j),p(s,o),E(A,i,j),E(A,c,j),p(c,h),p(h,k),p(h,w),p(h,d),m||(M=[oe(t,"click",Ie(n[26])),oe(o,"click",Ie(n[25]))],m=!0)},p(A,j){j[0]&262144&&v!==(v=A[18]+1+"")&&te(k,v),j[0]&4096&&y!==(y=A[12].length+"")&&te(d,y)},d(A){A&&(f(e),f(l),f(s),f(i),f(c)),m=!1,st(M)}}}function He(n){let e;function t(s,o){return s[37].type==="image"?Et:s[37].type==="video"?yt:s[37].type==="audio"?$t:kt}let r=t(n),l=r(n);return{c(){l.c(),e=fe()},l(s){l.l(s),e=fe()},m(s,o){l.m(s,o),E(s,e,o)},p(s,o){r===(r=t(s))&&l?l.p(s,o):(l.d(1),l=r(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&f(e),l.d(s)}}}function kt(n){let e,t,r,l,s,o=(n[37].name||"Attachment")+"",a;return{c(){e=C("div"),t=Q("svg"),r=Q("path"),l=U(),s=C("p"),a=R(o),this.h()},l(i){e=I(i,"DIV",{class:!0});var c=$(e);t=X(c,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var h=$(t);r=X(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(r).forEach(f),h.forEach(f),l=z(c),s=I(c,"P",{class:!0});var v=$(s);a=Y(v,o),v.forEach(f),c.forEach(f),this.h()},h(){u(r,"stroke-linecap","round"),u(r,"stroke-linejoin","round"),u(r,"stroke-width","1.5"),u(r,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"class","h-12 w-12 mx-auto text-neutral-500 mb-2"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke","currentColor"),u(s,"class","text-sm text-gray-700 dark:text-gray-300"),u(e,"class","p-4 bg-neutral-200 dark:bg-neutral-800 text-center")},m(i,c){E(i,e,c),p(e,t),p(t,r),p(e,l),p(e,s),p(s,a)},p(i,c){c[0]&266240&&o!==(o=(i[37].name||"Attachment")+"")&&te(a,o)},d(i){i&&f(e)}}}function $t(n){let e,t,r,l,s,o,a,i,c,h=(n[37].name||"Audio file")+"",v,k,w;return{c(){e=C("div"),t=Q("svg"),r=Q("path"),l=U(),s=C("audio"),o=R("Your browser does not support the audio tag."),i=U(),c=C("p"),v=R(h),this.h()},l(y){e=I(y,"DIV",{class:!0});var d=$(e);t=X(d,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var m=$(t);r=X(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(r).forEach(f),m.forEach(f),l=z(d),s=I(d,"AUDIO",{src:!0,class:!0});var M=$(s);o=Y(M,"Your browser does not support the audio tag."),M.forEach(f),i=z(d),c=I(d,"P",{class:!0});var A=$(c);v=Y(A,h),A.forEach(f),d.forEach(f),this.h()},h(){u(r,"stroke-linecap","round"),u(r,"stroke-linejoin","round"),u(r,"stroke-width","1.5"),u(r,"d","M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"class","h-12 w-12 text-neutral-500 mb-2"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke","currentColor"),ae(s.src,a=n[37].url)||u(s,"src",a),s.controls=!0,u(s,"class","w-full max-w-md"),u(c,"class","mt-2 text-sm text-gray-700 dark:text-gray-300"),u(e,"class","flex flex-col items-center justify-center p-4 bg-neutral-200 dark:bg-neutral-800")},m(y,d){E(y,e,d),p(e,t),p(t,r),p(e,l),p(e,s),p(s,o),p(e,i),p(e,c),p(c,v),k||(w=oe(s,"error",Me),k=!0)},p(y,d){d[0]&266240&&!ae(s.src,a=y[37].url)&&u(s,"src",a),d[0]&266240&&h!==(h=(y[37].name||"Audio file")+"")&&te(v,h)},d(y){y&&f(e),k=!1,w()}}}function yt(n){let e,t,r,l,s;return{c(){e=C("video"),t=R("Your browser does not support the video tag."),this.h()},l(o){e=I(o,"VIDEO",{src:!0,class:!0});var a=$(e);t=Y(a,"Your browser does not support the video tag."),a.forEach(f),this.h()},h(){ae(e.src,r=n[37].url)||u(e,"src",r),e.controls=!0,u(e,"class","max-h-96 w-full object-contain")},m(o,a){E(o,e,a),p(e,t),l||(s=oe(e,"error",Me),l=!0)},p(o,a){a[0]&266240&&!ae(e.src,r=o[37].url)&&u(e,"src",r)},d(o){o&&f(e),l=!1,s()}}}function Et(n){let e,t,r,l,s;return{c(){e=C("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ae(e.src,t=n[37].url)||u(e,"src",t),u(e,"alt",r=n[37].name||"Comment attachment"),u(e,"class","max-h-96 w-full object-contain")},m(o,a){E(o,e,a),l||(s=oe(e,"error",Me),l=!0)},p(o,a){a[0]&266240&&!ae(e.src,t=o[37].url)&&u(e,"src",t),a[0]&266240&&r!==(r=o[37].name||"Comment attachment")&&u(e,"alt",r)},d(o){o&&f(e),l=!1,s()}}}function Le(n){let e,t=de(n[12]),r=[];for(let l=0;l<t.length;l+=1)r[l]=Re(ze(n,t,l));return{c(){e=C("div");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){e=I(l,"DIV",{class:!0});var s=$(e);for(let o=0;o<r.length;o+=1)r[o].l(s);s.forEach(f),this.h()},h(){u(e,"class","flex overflow-x-auto gap-1 p-1 bg-neutral-200 dark:bg-neutral-800")},m(l,s){E(l,e,s);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(l,s){if(s[0]&266240){t=de(l[12]);let o;for(o=0;o<t.length;o+=1){const a=ze(l,t,o);r[o]?r[o].p(a,s):(r[o]=Re(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(l){l&&f(e),nt(r,l)}}}function Ct(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';return{c(){e=C("div"),e.innerHTML=t,this.h()},l(r){e=I(r,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1rycusf"&&(e.innerHTML=t),this.h()},h(){u(e,"class","w-full h-full bg-neutral-300 dark:bg-neutral-700 flex items-center justify-center")},m(r,l){E(r,e,l)},p:me,d(r){r&&f(e)}}}function It(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg>';return{c(){e=C("div"),e.innerHTML=t,this.h()},l(r){e=I(r,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-414caj"&&(e.innerHTML=t),this.h()},h(){u(e,"class","w-full h-full bg-neutral-300 dark:bg-neutral-700 flex items-center justify-center")},m(r,l){E(r,e,l)},p:me,d(r){r&&f(e)}}}function jt(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';return{c(){e=C("div"),e.innerHTML=t,this.h()},l(r){e=I(r,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1yxcl89"&&(e.innerHTML=t),this.h()},h(){u(e,"class","w-full h-full bg-neutral-300 dark:bg-neutral-700 flex items-center justify-center")},m(r,l){E(r,e,l)},p:me,d(r){r&&f(e)}}}function Dt(n){let e,t;return{c(){e=C("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ae(e.src,t=n[37].url)||u(e,"src",t),u(e,"alt","thumbnail"),u(e,"class","w-full h-full object-cover")},m(r,l){E(r,e,l)},p(r,l){l[0]&4096&&!ae(e.src,t=r[37].url)&&u(e,"src",t)},d(r){r&&f(e)}}}function Re(n){let e,t,r,l,s;function o(h,v){return h[37].type==="image"?Dt:h[37].type==="video"?jt:h[37].type==="audio"?It:Ct}let a=o(n),i=a(n);function c(){return n[28](n[39])}return{c(){e=C("button"),i.c(),t=U(),this.h()},l(h){e=I(h,"BUTTON",{class:!0});var v=$(e);i.l(v),t=z(v),v.forEach(f),this.h()},h(){u(e,"class",r="flex-shrink-0 w-12 h-12 rounded overflow-hidden focus:outline-none transition-all "+(n[39]===n[18]?"ring-2 ring-neutral-500 transform scale-105":"opacity-60 hover:opacity-100"))},m(h,v){E(h,e,v),i.m(e,null),p(e,t),l||(s=oe(e,"click",Ie(c)),l=!0)},p(h,v){n=h,a===(a=o(n))&&i?i.p(n,v):(i.d(1),i=a(n),i&&(i.c(),i.m(e,t))),v[0]&262144&&r!==(r="flex-shrink-0 w-12 h-12 rounded overflow-hidden focus:outline-none transition-all "+(n[39]===n[18]?"ring-2 ring-neutral-500 transform scale-105":"opacity-60 hover:opacity-100"))&&u(e,"class",r)},d(h){h&&f(e),i.d(),l=!1,s()}}}function Mt(n){let e,t,r=(n[7]||"Anonymous")+"",l,s,o,a,i="•",c,h,v=n[23](n[8])+"",k,w,y,d,m=(n[6]||"No content")+"",M,A,j,W,O,_,T,g,N,D,F=n[1]-n[2]+"",S,Z,ee,x,le,pe,ge,be,b=n[0]&&Se(),H=n[12]&&n[12].length>0&&Pe(n);return{c(){e=C("div"),t=C("a"),l=R(r),o=U(),a=C("span"),a.textContent=i,c=U(),h=C("span"),k=R(v),w=U(),b&&b.c(),y=U(),d=C("div"),M=R(m),A=U(),H&&H.c(),j=U(),W=C("div"),O=C("button"),_=Q("svg"),T=Q("path"),N=U(),D=C("span"),S=R(F),Z=U(),ee=C("button"),x=Q("svg"),le=Q("path"),this.h()},l(V){e=I(V,"DIV",{class:!0});var L=$(e);t=I(L,"A",{href:!0,class:!0});var _e=$(t);l=Y(_e,r),_e.forEach(f),o=z(L),a=I(L,"SPAN",{"data-svelte-h":!0}),ie(a)!=="svelte-7hh8jk"&&(a.textContent=i),c=z(L),h=I(L,"SPAN",{});var re=$(h);k=Y(re,v),re.forEach(f),w=z(L),b&&b.l(L),L.forEach(f),y=z(V),d=I(V,"DIV",{class:!0});var he=$(d);M=Y(he,m),he.forEach(f),A=z(V),H&&H.l(V),j=z(V),W=I(V,"DIV",{class:!0});var se=$(W);O=I(se,"BUTTON",{class:!0});var ve=$(O);_=X(ve,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var Ae=$(_);T=X(Ae,"path",{d:!0}),$(T).forEach(f),Ae.forEach(f),ve.forEach(f),N=z(se),D=I(se,"SPAN",{class:!0});var Te=$(D);S=Y(Te,F),Te.forEach(f),Z=z(se),ee=I(se,"BUTTON",{class:!0});var Fe=$(ee);x=X(Fe,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var Oe=$(x);le=X(Oe,"path",{d:!0}),$(le).forEach(f),Oe.forEach(f),Fe.forEach(f),se.forEach(f),this.h()},h(){u(t,"href",s=`/user/${n[7]}`),u(t,"class","font-medium hover:text-rose-900 hover:underline"),u(e,"class","flex flex-wrap items-center gap-2 text-sm text-gray-600 mb-2"),u(d,"class","text-neutral-900 dark:text-neutral-100"),u(T,"d","M5 14l5-5 5 5H5z"),u(_,"xmlns","http://www.w3.org/2000/svg"),u(_,"class","h-5 w-5"),u(_,"viewBox","0 0 20 20"),u(_,"fill","currentColor"),u(O,"class",g="flex items-center justify-center hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-full w-8 h-8 transition-colors "+(n[3]?"text-teal-600":"text-gray-600")),u(D,"class","text-sm font-medium"),u(le,"d","M5 6l5 5 5-5H5z"),u(x,"xmlns","http://www.w3.org/2000/svg"),u(x,"class","h-5 w-5"),u(x,"viewBox","0 0 20 20"),u(x,"fill","currentColor"),u(ee,"class",pe="flex items-center justify-center hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-full w-8 h-8 transition-colors "+(n[4]?"text-rose-600":"text-gray-500")),u(W,"class","flex items-center gap-2 mt-3")},m(V,L){E(V,e,L),p(e,t),p(t,l),p(e,o),p(e,a),p(e,c),p(e,h),p(h,k),p(e,w),b&&b.m(e,null),E(V,y,L),E(V,d,L),p(d,M),E(V,A,L),H&&H.m(V,L),E(V,j,L),E(V,W,L),p(W,O),p(O,_),p(_,T),p(W,N),p(W,D),p(D,S),p(W,Z),p(W,ee),p(ee,x),p(x,le),ge||(be=[oe(O,"click",n[29]),oe(ee,"click",n[30])],ge=!0)},p(V,L){L[0]&128&&r!==(r=(V[7]||"Anonymous")+"")&&te(l,r),L[0]&128&&s!==(s=`/user/${V[7]}`)&&u(t,"href",s),L[0]&256&&v!==(v=V[23](V[8])+"")&&te(k,v),V[0]?b||(b=Se(),b.c(),b.m(e,null)):b&&(b.d(1),b=null),L[0]&64&&m!==(m=(V[6]||"No content")+"")&&te(M,m),V[12]&&V[12].length>0?H?H.p(V,L):(H=Pe(V),H.c(),H.m(j.parentNode,j)):H&&(H.d(1),H=null),L[0]&8&&g!==(g="flex items-center justify-center hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-full w-8 h-8 transition-colors "+(V[3]?"text-teal-600":"text-gray-600"))&&u(O,"class",g),L[0]&6&&F!==(F=V[1]-V[2]+"")&&te(S,F),L[0]&16&&pe!==(pe="flex items-center justify-center hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-full w-8 h-8 transition-colors "+(V[4]?"text-rose-600":"text-gray-500"))&&u(ee,"class",pe)},d(V){V&&(f(e),f(y),f(d),f(A),f(j),f(W)),b&&b.d(),H&&H.d(V),ge=!1,st(be)}}}function Ye(n){let e,t;return e=new we({props:{variant:"outline",class:"text-xs py-1 px-3 hover:bg-neutral-100 dark:hover:bg-neutral-800",$$slots:{default:[At]},$$scope:{ctx:n}}}),e.$on("click",n[24]),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l[1]&512&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function At(n){let e;return{c(){e=R("Mark as Best Answer")},l(t){e=Y(t,"Mark as Best Answer")},m(t,r){E(t,e,r)},d(t){t&&f(e)}}}function Tt(n){let e=n[13]?"Cancel":"Reply",t;return{c(){t=R(e)},l(r){t=Y(r,e)},m(r,l){E(r,t,l)},p(r,l){l[0]&8192&&e!==(e=r[13]?"Cancel":"Reply")&&te(t,e)},d(r){r&&f(t)}}}function We(n){let e,t,r,l,s,o,a,i,c,h;function v(d){n[31](d)}let k={class:"w-full p-2 border rounded-lg text-sm bg-white dark:bg-neutral-800 border-neutral-200 dark:border-neutral-700",placeholder:"Write your reply..."};n[14]!==void 0&&(k.value=n[14]),t=new ft({props:k}),ke.push(()=>je(t,"value",v));function w(d){n[32](d)}let y={};return n[15]!==void 0&&(y.mediaFiles=n[15]),o=new pt({props:y}),ke.push(()=>je(o,"mediaFiles",w)),o.$on("update",n[20]),c=new we({props:{variant:"outline",class:"mt-2 text-xs py-1 px-3 hover:bg-rose-900 hover:text-white transition-colors",disabled:n[16],$$slots:{default:[Vt]},$$scope:{ctx:n}}}),c.$on("click",n[21]),{c(){e=C("div"),q(t.$$.fragment),l=U(),s=C("div"),q(o.$$.fragment),i=U(),q(c.$$.fragment),this.h()},l(d){e=I(d,"DIV",{class:!0});var m=$(e);G(t.$$.fragment,m),l=z(m),s=I(m,"DIV",{class:!0});var M=$(s);G(o.$$.fragment,M),M.forEach(f),i=z(m),G(c.$$.fragment,m),m.forEach(f),this.h()},h(){u(s,"class","my-3"),u(e,"class","p-4 pt-0")},m(d,m){E(d,e,m),J(t,e,null),p(e,l),p(e,s),J(o,s,null),p(e,i),J(c,e,null),h=!0},p(d,m){const M={};!r&&m[0]&16384&&(r=!0,M.value=d[14],Ce(()=>r=!1)),t.$set(M);const A={};!a&&m[0]&32768&&(a=!0,A.mediaFiles=d[15],Ce(()=>a=!1)),o.$set(A);const j={};m[0]&65536&&(j.disabled=d[16]),m[0]&65536|m[1]&512&&(j.$$scope={dirty:m,ctx:d}),c.$set(j)},i(d){h||(B(t.$$.fragment,d),B(o.$$.fragment,d),B(c.$$.fragment,d),h=!0)},o(d){P(t.$$.fragment,d),P(o.$$.fragment,d),P(c.$$.fragment,d),h=!1},d(d){d&&f(e),K(t),K(o),K(c)}}}function Ft(n){let e;return{c(){e=R("Submit Reply")},l(t){e=Y(t,"Submit Reply")},m(t,r){E(t,e,r)},d(t){t&&f(e)}}}function Ot(n){let e,t;return{c(){e=C("span"),t=R(`\r
              Uploading...`),this.h()},l(r){e=I(r,"SPAN",{class:!0}),$(e).forEach(f),t=Y(r,`\r
              Uploading...`),this.h()},h(){u(e,"class","inline-block h-4 w-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2")},m(r,l){E(r,e,l),E(r,t,l)},d(r){r&&(f(e),f(t))}}}function Vt(n){let e;function t(s,o){return s[16]?Ot:Ft}let r=t(n),l=r(n);return{c(){l.c(),e=fe()},l(s){l.l(s),e=fe()},m(s,o){l.m(s,o),E(s,e,o)},p(s,o){r!==(r=t(s))&&(l.d(1),l=r(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&f(e),l.d(s)}}}function qe(n){let e,t=[],r=new Map,l,s=de(n[10]);const o=a=>a[34].id;for(let a=0;a<s.length;a+=1){let i=Ue(n,s,a),c=o(i);r.set(c,t[a]=Ge(c,i))}return{c(){e=C("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var i=$(e);for(let c=0;c<t.length;c+=1)t[c].l(i);i.forEach(f),this.h()},h(){u(e,"class","pl-4 border-l-2 border-neutral-200 dark:border-neutral-700 ml-4 mb-4")},m(a,i){E(a,e,i);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);l=!0},p(a,i){i[0]&3616&&(s=de(a[10]),ue(),t=it(t,i,o,1,a,s,r,e,ut,Ge,null,Ue),ce())},i(a){if(!l){for(let i=0;i<s.length;i+=1)B(t[i]);l=!0}},o(a){for(let i=0;i<t.length;i+=1)P(t[i]);l=!1},d(a){a&&f(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}function Ge(n,e){let t,r,l,s;return r=new mt({props:{threadId:e[11],commentId:e[34].id,comment:e[34].content,commentator:e[34].author,postedDateComment:e[34].createdAt,selected:e[34].bestAnswer||!1,threadOwner:e[9],replies:e[34].replies||[],upvotes:e[34].upvotes,downvotes:e[34].downvotes,userUpvoted:e[34].userUpvoted,userDownvoted:e[34].userDownvoted,parentCommentId:e[5],mediaFiles:e[34].mediaFiles||[]}}),{key:n,first:null,c(){t=C("div"),q(r.$$.fragment),l=U(),this.h()},l(o){t=I(o,"DIV",{class:!0});var a=$(t);G(r.$$.fragment,a),l=z(a),a.forEach(f),this.h()},h(){u(t,"class","mt-2"),this.first=t},m(o,a){E(o,t,a),J(r,t,null),p(t,l),s=!0},p(o,a){e=o;const i={};a[0]&2048&&(i.threadId=e[11]),a[0]&1024&&(i.commentId=e[34].id),a[0]&1024&&(i.comment=e[34].content),a[0]&1024&&(i.commentator=e[34].author),a[0]&1024&&(i.postedDateComment=e[34].createdAt),a[0]&1024&&(i.selected=e[34].bestAnswer||!1),a[0]&512&&(i.threadOwner=e[9]),a[0]&1024&&(i.replies=e[34].replies||[]),a[0]&1024&&(i.upvotes=e[34].upvotes),a[0]&1024&&(i.downvotes=e[34].downvotes),a[0]&1024&&(i.userUpvoted=e[34].userUpvoted),a[0]&1024&&(i.userDownvoted=e[34].userDownvoted),a[0]&32&&(i.parentCommentId=e[5]),a[0]&1024&&(i.mediaFiles=e[34].mediaFiles||[]),r.$set(i)},i(o){s||(B(r.$$.fragment,o),s=!0)},o(o){P(r.$$.fragment,o),s=!1},d(o){o&&f(t),K(r)}}}function Bt(n){let e,t,r,l,s,o,a,i,c,h,v;t=new De({props:{class:"p-4",$$slots:{default:[Mt]},$$scope:{ctx:n}}}),l=new vt({});let k=n[17]&&!n[0]&&Ye(n);i=new we({props:{variant:"outline",class:"text-xs py-1 px-3 hover:bg-neutral-100 dark:hover:bg-neutral-800",$$slots:{default:[Tt]},$$scope:{ctx:n}}}),i.$on("click",n[19]);let w=n[13]&&We(n),y=n[10]&&n[10].length>0&&qe(n);return{c(){e=C("div"),q(t.$$.fragment),r=U(),q(l.$$.fragment),s=U(),o=C("div"),k&&k.c(),a=U(),q(i.$$.fragment),c=U(),w&&w.c(),h=U(),y&&y.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var m=$(e);G(t.$$.fragment,m),r=z(m),G(l.$$.fragment,m),s=z(m),o=I(m,"DIV",{class:!0});var M=$(o);k&&k.l(M),a=z(M),G(i.$$.fragment,M),M.forEach(f),c=z(m),w&&w.l(m),h=z(m),y&&y.l(m),m.forEach(f),this.h()},h(){u(o,"class","p-4 flex flex-wrap gap-2"),u(e,"class","flex flex-col w-full")},m(d,m){E(d,e,m),J(t,e,null),p(e,r),J(l,e,null),p(e,s),p(e,o),k&&k.m(o,null),p(o,a),J(i,o,null),p(e,c),w&&w.m(e,null),p(e,h),y&&y.m(e,null),v=!0},p(d,m){const M={};m[0]&266719|m[1]&512&&(M.$$scope={dirty:m,ctx:d}),t.$set(M),d[17]&&!d[0]?k?(k.p(d,m),m[0]&131073&&B(k,1)):(k=Ye(d),k.c(),B(k,1),k.m(o,a)):k&&(ue(),P(k,1,1,()=>{k=null}),ce());const A={};m[0]&8192|m[1]&512&&(A.$$scope={dirty:m,ctx:d}),i.$set(A),d[13]?w?(w.p(d,m),m[0]&8192&&B(w,1)):(w=We(d),w.c(),B(w,1),w.m(e,h)):w&&(ue(),P(w,1,1,()=>{w=null}),ce()),d[10]&&d[10].length>0?y?(y.p(d,m),m[0]&1024&&B(y,1)):(y=qe(d),y.c(),B(y,1),y.m(e,null)):y&&(ue(),P(y,1,1,()=>{y=null}),ce())},i(d){v||(B(t.$$.fragment,d),B(l.$$.fragment,d),B(k),B(i.$$.fragment,d),B(w),B(y),v=!0)},o(d){P(t.$$.fragment,d),P(l.$$.fragment,d),P(k),P(i.$$.fragment,d),P(w),P(y),v=!1},d(d){d&&f(e),K(t),K(l),k&&k.d(),K(i),w&&w.d(),y&&y.d()}}}function Ut(n){let e,t,r;return t=new ye({props:{class:`w-full bg-opacity-90 hover:bg-opacity-100 relative ${n[0]?"border-2 border-teal-600 dark:border-teal-800":""}`,$$slots:{default:[Bt]},$$scope:{ctx:n}}}),{c(){e=C("div"),q(t.$$.fragment),this.h()},l(l){e=I(l,"DIV",{class:!0});var s=$(e);G(t.$$.fragment,s),s.forEach(f),this.h()},h(){u(e,"class","flex w-full py-1")},m(l,s){E(l,e,s),J(t,e,null),r=!0},p(l,s){const o={};s[0]&1&&(o.class=`w-full bg-opacity-90 hover:bg-opacity-100 relative ${l[0]?"border-2 border-teal-600 dark:border-teal-800":""}`),s[0]&524287|s[1]&512&&(o.$$scope={dirty:s,ctx:l}),t.$set(o)},i(l){r||(B(t.$$.fragment,l),r=!0)},o(l){P(t.$$.fragment,l),r=!1},d(l){l&&f(e),K(t)}}}function zt(n){const t=`; ${document.cookie}`.split(`; ${n}=`);return t.length===2?t.pop().split(";").shift():null}function Me(n){console.error("Media failed to load:",n)}function St(n,e,t){let{commentId:r}=e,{comment:l}=e,{commentator:s}=e,{postedDateComment:o}=e,{selected:a=!1}=e,{threadOwner:i}=e,{replies:c=[]}=e,{threadId:h}=e,{upvotes:v=0}=e,{downvotes:k=0}=e,{userUpvoted:w=!1}=e,{userDownvoted:y=!1}=e,{mediaFiles:d=[]}=e,m=null,M=!1,A="",j=[],W=!1,O=!1,_=0;lt(()=>{typeof l=="object"&&l!==null&&(t(1,v=l.upvotes||0),t(2,k=l.downvotes||0),t(3,w=l.userUpvoted||!1),t(4,y=l.userDownvoted||!1))});const T=()=>{t(13,M=!M),M||t(15,j=[])};function g(b){t(15,j=b.detail.mediaFiles)}const N=async()=>{if(!(!A.trim()&&j.length===0))try{const b=$e();if(!b.Authorization){console.error("Please log in to reply");return}const H={content:A,postId:h,parentCommentId:r},V=await fetch(`${ne}/api/comments/create`,{method:"POST",headers:{"Content-Type":"application/json",...b},body:JSON.stringify(H)});if(!V.ok){const re=await V.text();throw new Error(`Failed to add reply: ${re}`)}const _e=(await V.json()).commentId;if(j.length>0){t(16,W=!0);for(let re=0;re<j.length;re++){const he=j[re],se=new FormData;se.append("file",he.file),se.append("type",he.type||"image");try{(await fetch(`${ne}/api/comments/${_e}/upload-media`,{method:"POST",headers:{...b},body:se})).ok||console.error(`Failed to upload media file ${re+1} for reply`)}catch(ve){console.error(`Error uploading media file ${re+1} for reply:`,ve)}}t(16,W=!1)}t(14,A=""),t(15,j=[]),t(13,M=!1),document.dispatchEvent(new CustomEvent("refreshComments",{bubbles:!0,detail:{threadId:h}}))}catch(b){console.error("Error adding reply:",b)}},D=async b=>{try{const H=$e();if(!H.Authorization){console.error("Please log in to vote");return}const V=await fetch(`${ne}/api/comments/${b?"upvote":"downvote"}/${r}`,{method:"POST",headers:{"Content-Type":"application/json",...H}});if(!V.ok)throw new Error(`Vote failed: ${V.status}`);const L=await V.json();L&&(t(1,v=L.upvotes||v),t(2,k=L.downvotes||k),t(3,w=b),t(4,y=!b))}catch(H){console.error("Error voting:",H)}},F=b=>{if(!b)return"";const H=new Date(b),V={hour:"numeric",minute:"numeric",hour12:!1},L=new Intl.DateTimeFormat("en-US",V).format(H),_e=H.getDate(),re=H.toLocaleString("en-US",{month:"short"}),he=H.getFullYear();return`${L}, ${_e} ${re} ${he}`},S=async()=>{try{if(!O){console.error("Only the thread owner can mark best answers");return}const b=zt("tokenKey");if(!b){console.error("No auth token found");return}const H=await fetch(`${ne}/api/posts/${h}/markBestAnswer/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`}});if(H.status===403){console.error("You don't have permission to mark best answers");return}if(!H.ok)throw new Error(`Failed to mark best answer: ${H.status}`);t(0,a=!a),document.dispatchEvent(new CustomEvent("refreshComments",{bubbles:!0,detail:{threadId:h}}))}catch(b){console.error("Error toggling best answer status:",b)}},Z=()=>{d.length>1&&t(18,_=(_+1)%d.length)},ee=()=>{d.length>1&&t(18,_=(_-1+d.length)%d.length)},x=b=>t(18,_=b),le=()=>D(!0),pe=()=>D(!1);function ge(b){A=b,t(14,A)}function be(b){j=b,t(15,j)}return n.$$set=b=>{"commentId"in b&&t(5,r=b.commentId),"comment"in b&&t(6,l=b.comment),"commentator"in b&&t(7,s=b.commentator),"postedDateComment"in b&&t(8,o=b.postedDateComment),"selected"in b&&t(0,a=b.selected),"threadOwner"in b&&t(9,i=b.threadOwner),"replies"in b&&t(10,c=b.replies),"threadId"in b&&t(11,h=b.threadId),"upvotes"in b&&t(1,v=b.upvotes),"downvotes"in b&&t(2,k=b.downvotes),"userUpvoted"in b&&t(3,w=b.userUpvoted),"userDownvoted"in b&&t(4,y=b.userDownvoted),"mediaFiles"in b&&t(12,d=b.mediaFiles)},n.$$.update=()=>{n.$$.dirty[0]&134218240&&dt.subscribe(b=>{t(27,m=b),t(17,O=m===i)})},[a,v,k,w,y,r,l,s,o,i,c,h,d,M,A,j,W,O,_,T,g,N,D,F,S,Z,ee,m,x,le,pe,ge,be]}class mt extends ot{constructor(e){super(),at(this,e,St,Ut,rt,{commentId:5,comment:6,commentator:7,postedDateComment:8,selected:0,threadOwner:9,replies:10,threadId:11,upvotes:1,downvotes:2,userUpvoted:3,userDownvoted:4,mediaFiles:12},null,[-1,-1])}}function Pt(n){var t,r;if(!n)return[];const e=[];return n.mediaFiles&&Array.isArray(n.mediaFiles)&&n.mediaFiles.length>0?n.mediaFiles.forEach(l=>{const s=l.fileType?l.fileType.split("/"):["unknown"],o=s[0]==="image"?"image":s[0]==="video"?"video":s[0]==="audio"?"audio":"unknown";e.push({id:l.id,type:o,url:`${ne}/api/mysteryObjects/media/${l.id}`,name:l.fileName||`Media ${l.id}`,fileType:l.fileType})}):(t=n.mysteryObject)!=null&&t.image?e.push({type:"image",url:`data:image/png;base64,${n.mysteryObject.image}`,name:"Main Image"}):(r=n.mysteryObject)!=null&&r.imageUrl&&e.push({type:"image",url:n.mysteryObject.imageUrl,name:"Main Image"}),e}function Nt(n){return!n||!n.mediaFiles?[]:n.mediaFiles.map(e=>{const t=e.fileType?e.fileType.split("/"):["unknown"],r=t[0]==="image"?"image":t[0]==="video"?"video":t[0]==="audio"?"audio":"unknown";return{id:e.id,type:r,url:`${ne}/api/mysteryObjects/media/${e.id}`,name:e.fileName||`Media ${e.id}`,fileType:e.fileType}})}function Je(n,e,t){const r=n.slice();return r[20]=e[t],r}function Ke(n,e,t){const r=n.slice();return r[23]=e[t],r[25]=t,r}function Qe(n){let e,t;return e=new gt({props:{id:n[0].id,title:n[1].title,description:n[1].description,tags:n[1].tags,mysteryObject:n[1].mysteryObject,imageSrc:n[1].mysteryObjectImage?`data:image/png;base64,${n[1].mysteryObjectImage}`:"",mediaFiles:n[1].mediaFiles||[],postedBy:n[1].author,postedDate:n[1].createdAt,upvotes:n[1].upvotes,downvotes:n[1].downvotes,userUpvoted:n[1].userUpvoted,userDownvoted:n[1].userDownvoted,createdAt:n[1].createdAt,updatedAt:n[1].updatedAt,solved:n[1].solved,variant:"thread"}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&1&&(s.id=r[0].id),l&2&&(s.title=r[1].title),l&2&&(s.description=r[1].description),l&2&&(s.tags=r[1].tags),l&2&&(s.mysteryObject=r[1].mysteryObject),l&2&&(s.imageSrc=r[1].mysteryObjectImage?`data:image/png;base64,${r[1].mysteryObjectImage}`:""),l&2&&(s.mediaFiles=r[1].mediaFiles||[]),l&2&&(s.postedBy=r[1].author),l&2&&(s.postedDate=r[1].createdAt),l&2&&(s.upvotes=r[1].upvotes),l&2&&(s.downvotes=r[1].downvotes),l&2&&(s.userUpvoted=r[1].userUpvoted),l&2&&(s.userDownvoted=r[1].userDownvoted),l&2&&(s.createdAt=r[1].createdAt),l&2&&(s.updatedAt=r[1].updatedAt),l&2&&(s.solved=r[1].solved),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Ht(n){let e,t;return e=new ye({props:{class:"bg-opacity-90 hover:bg-opacity-100 mt-4",$$slots:{default:[Wt]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Lt(n){let e,t;return e=new ye({props:{class:"bg-opacity-90 hover:bg-opacity-100 p-4 mt-4 flex flex-col justify-center items-center",$$slots:{default:[er]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67109304&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Rt(n){let e;return{c(){e=R("Sign in to comment")},l(t){e=Y(t,"Sign in to comment")},m(t,r){E(t,e,r)},d(t){t&&f(e)}}}function Yt(n){let e,t;return e=new ct({props:{class:"text-lg text-center pb-6",$$slots:{default:[Rt]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function Wt(n){let e,t;return e=new De({props:{$$slots:{default:[Yt]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function qt(n){let e,t,r;return{c(){e=Q("svg"),t=Q("path"),r=R(`\r
                Add Media`),this.h()},l(l){e=X(l,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var s=$(e);t=X(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),$(t).forEach(f),s.forEach(f),r=Y(l,`\r
                Add Media`),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"),u(t,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-4 w-4 mr-1"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(l,s){E(l,e,s),p(e,t),E(l,r,s)},p:me,d(l){l&&(f(e),f(r))}}}function Xe(n){let e,t=n[7].length+"",r,l,s=n[7].length!==1?"s":"",o,a;return{c(){e=C("span"),r=R(t),l=R(" file"),o=R(s),a=R(" selected"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=$(e);r=Y(c,t),l=Y(c," file"),o=Y(c,s),a=Y(c," selected"),c.forEach(f),this.h()},h(){u(e,"class","text-xs text-neutral-500")},m(i,c){E(i,e,c),p(e,r),p(e,l),p(e,o),p(e,a)},p(i,c){c&128&&t!==(t=i[7].length+"")&&te(r,t),c&128&&s!==(s=i[7].length!==1?"s":"")&&te(o,s)},d(i){i&&f(e)}}}function Gt(n){let e,t,r;return{c(){e=Q("svg"),t=Q("path"),r=R(`\r
                Post Comment`),this.h()},l(l){e=X(l,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var s=$(e);t=X(s,"path",{d:!0}),$(t).forEach(f),s.forEach(f),r=Y(l,`\r
                Post Comment`),this.h()},h(){u(t,"d","M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-4 w-4 mr-1"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(l,s){E(l,e,s),p(e,t),E(l,r,s)},p:me,d(l){l&&(f(e),f(r))}}}function Jt(n){let e,t,r=n[7].length>0?"Uploading...":"Sending...",l;return{c(){e=C("span"),t=U(),l=R(r),this.h()},l(s){e=I(s,"SPAN",{class:!0}),$(e).forEach(f),t=z(s),l=Y(s,r),this.h()},h(){u(e,"class","inline-block h-4 w-4 border-2 border-current/30 border-t-current rounded-full animate-spin mr-2")},m(s,o){E(s,e,o),E(s,t,o),E(s,l,o)},p(s,o){o&128&&r!==(r=s[7].length>0?"Uploading...":"Sending...")&&te(l,r)},d(s){s&&(f(e),f(t),f(l))}}}function Kt(n){let e;function t(s,o){return s[4]?Jt:Gt}let r=t(n),l=r(n);return{c(){l.c(),e=fe()},l(s){l.l(s),e=fe()},m(s,o){l.m(s,o),E(s,e,o)},p(s,o){r===(r=t(s))&&l?l.p(s,o):(l.d(1),l=r(s),l&&(l.c(),l.m(e.parentNode,e)))},d(s){s&&f(e),l.d(s)}}}function Ze(n){let e,t=de(n[7]),r=[];for(let l=0;l<t.length;l+=1)r[l]=xe(Ke(n,t,l));return{c(){e=C("div");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){e=I(l,"DIV",{class:!0});var s=$(e);for(let o=0;o<r.length;o+=1)r[o].l(s);s.forEach(f),this.h()},h(){u(e,"class","mt-2 flex flex-wrap gap-2")},m(l,s){E(l,e,s);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(l,s){if(s&128){t=de(l[7]);let o;for(o=0;o<t.length;o+=1){const a=Ke(l,t,o);r[o]?r[o].p(a,s):(r[o]=xe(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(l){l&&f(e),nt(r,l)}}}function Qt(n){let e,t;return{c(){e=Q("svg"),t=Q("path"),this.h()},l(r){e=X(r,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=$(e);t=X(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(t).forEach(f),l.forEach(f),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"stroke-width","2"),u(t,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-8 w-8 text-neutral-500"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke","currentColor")},m(r,l){E(r,e,l),p(e,t)},p:me,d(r){r&&f(e)}}}function Xt(n){let e,t;return{c(){e=Q("svg"),t=Q("path"),this.h()},l(r){e=X(r,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=$(e);t=X(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(t).forEach(f),l.forEach(f),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"stroke-width","2"),u(t,"d","M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-8 w-8 text-neutral-500"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke","currentColor")},m(r,l){E(r,e,l),p(e,t)},p:me,d(r){r&&f(e)}}}function Zt(n){let e,t,r;return{c(){e=Q("svg"),t=Q("path"),r=Q("path"),this.h()},l(l){e=X(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var s=$(e);t=X(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(t).forEach(f),r=X(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),$(r).forEach(f),s.forEach(f),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"stroke-width","2"),u(t,"d","M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"),u(r,"stroke-linecap","round"),u(r,"stroke-linejoin","round"),u(r,"stroke-width","2"),u(r,"d","M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-8 w-8 text-neutral-500"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke","currentColor")},m(l,s){E(l,e,s),p(e,t),p(e,r)},p:me,d(l){l&&f(e)}}}function xt(n){let e,t,r;return{c(){e=C("img"),this.h()},l(l){e=I(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ae(e.src,t=URL.createObjectURL(n[23]))||u(e,"src",t),u(e,"alt",r=n[23].name),u(e,"class","max-w-full max-h-full object-contain")},m(l,s){E(l,e,s)},p(l,s){s&128&&!ae(e.src,t=URL.createObjectURL(l[23]))&&u(e,"src",t),s&128&&r!==(r=l[23].name)&&u(e,"alt",r)},d(l){l&&f(e)}}}function xe(n){let e,t,r,l,s,o,a="×",i,c,h;function v(d,m){return m&128&&(t=null),m&128&&(r=null),m&128&&(l=null),t==null&&(t=!!d[23].type.startsWith("image/")),t?xt:(r==null&&(r=!!d[23].type.startsWith("video/")),r?Zt:(l==null&&(l=!!d[23].type.startsWith("audio/")),l?Xt:Qt))}let k=v(n,-1),w=k(n);function y(){return n[15](n[25])}return{c(){e=C("div"),w.c(),s=U(),o=C("button"),o.textContent=a,i=U(),this.h()},l(d){e=I(d,"DIV",{class:!0});var m=$(e);w.l(m),s=z(m),o=I(m,"BUTTON",{class:!0,"data-svelte-h":!0}),ie(o)!=="svelte-hc61wy"&&(o.textContent=a),i=z(m),m.forEach(f),this.h()},h(){u(o,"class","absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs"),u(e,"class","relative bg-neutral-100 dark:bg-neutral-800 rounded p-1 w-16 h-16 flex items-center justify-center")},m(d,m){E(d,e,m),w.m(e,null),p(e,s),p(e,o),p(e,i),c||(h=oe(o,"click",y),c=!0)},p(d,m){n=d,k===(k=v(n,m))&&w?w.p(n,m):(w.d(1),w=k(n),w&&(w.c(),w.m(e,s)))},d(d){d&&f(e),w.d(),c=!1,h()}}}function et(n){let e,t;return{c(){e=C("p"),t=R(n[5]),this.h()},l(r){e=I(r,"P",{class:!0});var l=$(e);t=Y(l,n[5]),l.forEach(f),this.h()},h(){u(e,"class","text-red-500 text-sm")},m(r,l){E(r,e,l),p(e,t)},p(r,l){l&32&&te(t,r[5])},d(r){r&&f(e)}}}function er(n){let e,t,r,l,s,o,a,i,c,h,v,k,w,y,d,m,M,A;function j(g){n[12](g)}let W={class:"w-full resize-none p-2",placeholder:"Write your comment..."};n[3]!==void 0&&(W.value=n[3]),t=new ft({props:W}),ke.push(()=>je(t,"value",j)),h=new we({props:{variant:"outline",size:"sm",class:"text-xs hover:bg-neutral-100 dark:hover:bg-neutral-800",$$slots:{default:[qt]},$$scope:{ctx:n}}}),h.$on("click",n[14]);let O=n[7].length>0&&Xe(n);w=new we({props:{variant:"outline",size:"sm",class:"text-xs hover:bg-neutral-100 dark:hover:bg-neutral-800",disabled:n[4],$$slots:{default:[Kt]},$$scope:{ctx:n}}}),w.$on("click",n[10]);let _=n[7].length>0&&Ze(n),T=n[5]&&et(n);return{c(){e=C("div"),q(t.$$.fragment),l=U(),s=C("div"),o=C("div"),a=C("div"),i=C("input"),c=U(),q(h.$$.fragment),v=U(),O&&O.c(),k=U(),q(w.$$.fragment),y=U(),_&&_.c(),d=U(),T&&T.c(),this.h()},l(g){e=I(g,"DIV",{class:!0});var N=$(e);G(t.$$.fragment,N),l=z(N),s=I(N,"DIV",{class:!0});var D=$(s);o=I(D,"DIV",{class:!0});var F=$(o);a=I(F,"DIV",{class:!0});var S=$(a);i=I(S,"INPUT",{type:!0,id:!0,accept:!0,class:!0}),c=z(S),G(h.$$.fragment,S),v=z(S),O&&O.l(S),S.forEach(f),k=z(F),G(w.$$.fragment,F),F.forEach(f),y=z(D),_&&_.l(D),D.forEach(f),d=z(N),T&&T.l(N),N.forEach(f),this.h()},h(){u(i,"type","file"),u(i,"id","media-upload"),u(i,"accept","image/*,video/*,audio/*"),u(i,"class","hidden"),i.multiple=!0,u(a,"class","flex items-center space-x-2"),u(o,"class","flex items-center justify-center gap-2"),u(s,"class","w-full"),u(e,"class","w-full space-y-4")},m(g,N){E(g,e,N),J(t,e,null),p(e,l),p(e,s),p(s,o),p(o,a),p(a,i),n[13](i),p(a,c),J(h,a,null),p(a,v),O&&O.m(a,null),p(o,k),J(w,o,null),p(s,y),_&&_.m(s,null),p(e,d),T&&T.m(e,null),m=!0,M||(A=oe(i,"change",n[9]),M=!0)},p(g,N){const D={};!r&&N&8&&(r=!0,D.value=g[3],Ce(()=>r=!1)),t.$set(D);const F={};N&67108864&&(F.$$scope={dirty:N,ctx:g}),h.$set(F),g[7].length>0?O?O.p(g,N):(O=Xe(g),O.c(),O.m(a,null)):O&&(O.d(1),O=null);const S={};N&16&&(S.disabled=g[4]),N&67109008&&(S.$$scope={dirty:N,ctx:g}),w.$set(S),g[7].length>0?_?_.p(g,N):(_=Ze(g),_.c(),_.m(s,null)):_&&(_.d(1),_=null),g[5]?T?T.p(g,N):(T=et(g),T.c(),T.m(e,null)):T&&(T.d(1),T=null)},i(g){m||(B(t.$$.fragment,g),B(h.$$.fragment,g),B(w.$$.fragment,g),m=!0)},o(g){P(t.$$.fragment,g),P(h.$$.fragment,g),P(w.$$.fragment,g),m=!1},d(g){g&&f(e),K(t),n[13](null),K(h),O&&O.d(),K(w),_&&_.d(),T&&T.d(),M=!1,A()}}}function tr(n){let e,t;return e=new ye({props:{class:"bg-opacity-90 hover:bg-opacity-100",$$slots:{default:[or]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function rr(n){let e=[],t=new Map,r,l,s=de(n[6]);const o=a=>a[20].id;for(let a=0;a<s.length;a+=1){let i=Je(n,s,a),c=o(i);t.set(c,e[a]=tt(c,i))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=fe()},l(a){for(let i=0;i<e.length;i+=1)e[i].l(a);r=fe()},m(a,i){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(a,i);E(a,r,i),l=!0},p(a,i){i&67&&(s=de(a[6]),ue(),e=it(e,i,o,1,a,s,t,r.parentNode,ut,tt,r,Je),ce())},i(a){if(!l){for(let i=0;i<s.length;i+=1)B(e[i]);l=!0}},o(a){for(let i=0;i<e.length;i+=1)P(e[i]);l=!1},d(a){a&&f(r);for(let i=0;i<e.length;i+=1)e[i].d(a)}}}function lr(n){let e;return{c(){e=R("There are no comments yet")},l(t){e=Y(t,"There are no comments yet")},m(t,r){E(t,e,r)},d(t){t&&f(e)}}}function sr(n){let e,t;return e=new ct({props:{class:"pb-2 text-lg text-center",$$slots:{default:[lr]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,l){J(e,r,l),t=!0},p(r,l){const s={};l&67108864&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function nr(n){let e;return{c(){e=R("Be the first to comment!")},l(t){e=Y(t,"Be the first to comment!")},m(t,r){E(t,e,r)},d(t){t&&f(e)}}}function or(n){let e,t,r,l;return e=new De({props:{$$slots:{default:[sr]},$$scope:{ctx:n}}}),r=new _t({props:{class:"p-4 text-center",$$slots:{default:[nr]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment),t=U(),q(r.$$.fragment)},l(s){G(e.$$.fragment,s),t=z(s),G(r.$$.fragment,s)},m(s,o){J(e,s,o),E(s,t,o),J(r,s,o),l=!0},p(s,o){const a={};o&67108864&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const i={};o&67108864&&(i.$$scope={dirty:o,ctx:s}),r.$set(i)},i(s){l||(B(e.$$.fragment,s),B(r.$$.fragment,s),l=!0)},o(s){P(e.$$.fragment,s),P(r.$$.fragment,s),l=!1},d(s){s&&f(t),K(e,s),K(r,s)}}}function tt(n,e){var o;let t,r,l,s;return r=new mt({props:{threadId:e[0].id,commentId:e[20].id,comment:e[20].content,commentator:e[20].author,postedDateComment:e[20].createdAt,selected:e[20].bestAnswer||!1,threadOwner:(o=e[1])==null?void 0:o.author,replies:e[20].replies||[],upvotes:e[20].upvotes,downvotes:e[20].downvotes,userUpvoted:e[20].userUpvoted,userDownvoted:e[20].userDownvoted,mediaFiles:e[20].mediaFiles||[]}}),{key:n,first:null,c(){t=C("div"),q(r.$$.fragment),l=U(),this.h()},l(a){t=I(a,"DIV",{class:!0});var i=$(t);G(r.$$.fragment,i),l=z(i),i.forEach(f),this.h()},h(){u(t,"class","mb-2"),this.first=t},m(a,i){E(a,t,i),J(r,t,null),p(t,l),s=!0},p(a,i){var h;e=a;const c={};i&1&&(c.threadId=e[0].id),i&64&&(c.commentId=e[20].id),i&64&&(c.comment=e[20].content),i&64&&(c.commentator=e[20].author),i&64&&(c.postedDateComment=e[20].createdAt),i&64&&(c.selected=e[20].bestAnswer||!1),i&2&&(c.threadOwner=(h=e[1])==null?void 0:h.author),i&64&&(c.replies=e[20].replies||[]),i&64&&(c.upvotes=e[20].upvotes),i&64&&(c.downvotes=e[20].downvotes),i&64&&(c.userUpvoted=e[20].userUpvoted),i&64&&(c.userDownvoted=e[20].userDownvoted),i&64&&(c.mediaFiles=e[20].mediaFiles||[]),r.$set(c)},i(a){s||(B(r.$$.fragment,a),s=!0)},o(a){P(r.$$.fragment,a),s=!1},d(a){a&&f(t),K(r)}}}function ar(n){let e,t,r,l,s,o,a,i,c,h,v,k,w=n[6].length+"",y,d,m,M,A,j=n[1]&&Qe(n);const W=[Lt,Ht],O=[];function _(D,F){return D[2]?0:1}l=_(n),s=O[l]=W[l](n);const T=[rr,tr],g=[];function N(D,F){return D[6].length>0?0:1}return m=N(n),M=g[m]=T[m](n),{c(){e=C("div"),t=C("div"),j&&j.c(),r=U(),s.c(),o=U(),a=C("div"),i=C("div"),c=C("div"),h=Q("svg"),v=Q("path"),k=R(`\r
          Comments: `),y=R(w),d=U(),M.c(),this.h()},l(D){e=I(D,"DIV",{class:!0});var F=$(e);t=I(F,"DIV",{class:!0});var S=$(t);j&&j.l(S),r=z(S),s.l(S),o=z(S),a=I(S,"DIV",{class:!0});var Z=$(a);i=I(Z,"DIV",{class:!0});var ee=$(i);c=I(ee,"DIV",{class:!0});var x=$(c);h=X(x,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var le=$(h);v=X(le,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),$(v).forEach(f),le.forEach(f),k=Y(x,`\r
          Comments: `),y=Y(x,w),x.forEach(f),ee.forEach(f),d=z(Z),M.l(Z),Z.forEach(f),S.forEach(f),F.forEach(f),this.h()},h(){u(v,"fill-rule","evenodd"),u(v,"d","M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z"),u(v,"clip-rule","evenodd"),u(h,"xmlns","http://www.w3.org/2000/svg"),u(h,"class","h-3.5 w-3.5 mr-1"),u(h,"viewBox","0 0 20 20"),u(h,"fill","currentColor"),u(c,"class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-neutral-50 dark:bg-neutral-950 text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700"),u(i,"class","flex items-center mb-1"),u(a,"class","flex flex-col justify-center pt-2"),u(t,"class","w-full lg:w-2/3"),u(e,"class","flex flex-col items-center bg-change dark:bg-dark shifting p-4 lg:p-8")},m(D,F){E(D,e,F),p(e,t),j&&j.m(t,null),p(t,r),O[l].m(t,null),p(t,o),p(t,a),p(a,i),p(i,c),p(c,h),p(h,v),p(c,k),p(c,y),p(a,d),g[m].m(a,null),A=!0},p(D,[F]){D[1]?j?(j.p(D,F),F&2&&B(j,1)):(j=Qe(D),j.c(),B(j,1),j.m(t,r)):j&&(ue(),P(j,1,1,()=>{j=null}),ce());let S=l;l=_(D),l===S?O[l].p(D,F):(ue(),P(O[S],1,1,()=>{O[S]=null}),ce(),s=O[l],s?s.p(D,F):(s=O[l]=W[l](D),s.c()),B(s,1),s.m(t,o)),(!A||F&64)&&w!==(w=D[6].length+"")&&te(y,w);let Z=m;m=N(D),m===Z?g[m].p(D,F):(ue(),P(g[Z],1,1,()=>{g[Z]=null}),ce(),M=g[m],M?M.p(D,F):(M=g[m]=T[m](D),M.c()),B(M,1),M.m(a,null))},i(D){A||(B(j),B(s),B(M),A=!0)},o(D){P(j),P(s),P(M),A=!1},d(D){D&&f(e),j&&j.d(),O[l].d(),g[m].d()}}}function ir(n){return!n||!Array.isArray(n)?[]:n.map(t=>{var r;return{...t,replies:((r=t.replies)==null?void 0:r.map(l=>({...l,parentCommentId:t.id})))||[]}})}function ur(n){return!n||typeof n!="string"?!1:/^#([0-9A-Fa-f]{3}){1,2}$/.test(n)}async function cr(n){try{const e=n.replace("#",""),t=await fetch(`https://www.thecolorapi.com/id?hex=${e}`);return t.ok?(await t.json()).name.value:null}catch(e){return console.error("Error fetching color name:",e),null}}function fr(n,e,t){let r,l;Ve(n,Be,_=>t(11,r=_)),Ve(n,dt,_=>t(2,l=_));let{data:s}=e,o="",a,i=!1,c=null,h=[],v=[],k,w;function y(_){const T=Array.from(_.target.files);T.length>0&&t(7,v=T)}async function d(_){try{const T=await fetch(`${ne}/api/posts/getForPostDetails/${_}`);if(!T.ok)throw new Error("Failed to fetch post details");const g=await T.json(),N=Pt(g);if(g.mysteryObject&&g.mysteryObject.color){const D=g.mysteryObject.color;if(ur(D)&&!g.mysteryObject._colorName)try{const F=await cr(D);F&&(g.mysteryObject._colorName=F)}catch(F){console.error("Error fetching color name:",F)}}return wt({id:g.id,...g,mediaFiles:N,mysteryObject:g.mysteryObject?{...g.mysteryObject,_colorName:g.mysteryObject._colorName}:null,title:g.title,description:g.description,tags:g.tags||[],author:g.author,createdAt:g.createdAt,updatedAt:g.updatedAt,upvotes:g.upvotes,downvotes:g.downvotes,userUpvoted:g.userUpvoted,userDownvoted:g.userDownvoted,solved:g.solved,comments:[]}),g}catch(T){throw console.error("Error fetching post with media:",T),T}}lt(async()=>{try{await d(s.id),await m(),w=async _=>{var T;((T=_.detail)==null?void 0:T.threadId)===s.id&&await m()},document.addEventListener("refreshComments",w)}catch(_){console.error("Error fetching thread data:",_)}}),ht(()=>{w&&document.removeEventListener("refreshComments",w)});async function m(){try{const _=await fetch(`${ne}/api/comments/get/${s.id}`,{headers:{...$e()}});if(!_.ok)throw new Error("Failed to fetch comments");const T=await _.json(),g=F=>{const S=Nt(F),Z=F.replies?F.replies.map(ee=>g(ee)):[];return{...F,mediaFiles:S,replies:Z}},N=T.map(F=>g(F)),D=ir(N);Be.update(F=>F.map(S=>S.id==s.id?{...S,comments:D}:S))}catch(_){console.error("Error refreshing comments:",_)}}let M=async()=>{if(!o.trim()&&v.length===0){t(5,c="Please enter a comment or attach media");return}t(4,i=!0),t(5,c=null);try{const _={content:o,postId:s.id,parentCommentId:null},T=await fetch(`${ne}/api/comments/create`,{method:"POST",headers:{"Content-Type":"application/json",...$e()},body:JSON.stringify(_)});if(!T.ok){const D=await T.text();throw new Error(`Failed to add comment: ${D}`)}const N=(await T.json()).commentId;if(v.length>0)for(let D=0;D<v.length;D++){const F=v[D],S=new FormData;S.append("file",F);try{(await fetch(`${ne}/api/comments/${N}/upload-media`,{method:"POST",body:S})).ok||console.error(`Failed to upload file ${D+1} for comment`)}catch(Z){console.error(`Error uploading file ${D+1} for comment:`,Z)}}t(3,o=""),t(7,v=[]),k&&t(8,k.value="",k),await m()}catch(_){console.error("Error submitting comment:",_),t(5,c=_.message||"Failed to submit comment")}finally{t(4,i=!1)}};function A(_){o=_,t(3,o)}function j(_){ke[_?"unshift":"push"](()=>{k=_,t(8,k)})}const W=()=>k==null?void 0:k.click(),O=_=>{t(7,v=v.filter((T,g)=>g!==_))};return n.$$set=_=>{"data"in _&&t(0,s=_.data)},n.$$.update=()=>{n.$$.dirty&4,n.$$.dirty&2049&&t(1,a=r.find(_=>_.id==s.id)),n.$$.dirty&2&&(a!=null&&a.comments?t(6,h=a.comments):t(6,h=[]))},[s,a,l,o,i,c,h,v,k,y,M,r,A,j,W,O]}class Cr extends ot{constructor(e){super(),at(this,e,fr,ar,rt,{data:0})}}export{Cr as component,Er as universal};
