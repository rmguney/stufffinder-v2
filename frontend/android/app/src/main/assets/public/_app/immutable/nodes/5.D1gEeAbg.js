import{a1 as It,a2 as Nt,s as Pe,y as x,i as I,f as g,u as ge,k as we,m as fe,v as We,T as Te,H as Ae,e as P,c as T,b as L,o as Ce,W as Lt,q as He,I as Ie,J as Ne,K as Le,r as jt,X as wt,z as Ee,A as Se,C as p,h as y,n as z,x as Dt,Q as Ot,a as V,g as U,B as Z,t as J,d as X,j as ve,E as ye,N as je,O as De,a3 as F}from"../chunks/CEgPK7Kn.js";import{S as Oe,i as Re,g as ue,b as M,e as de,t as D,f as Ct,c as ie,a as oe,m as ae,d as ce}from"../chunks/D5iEvBOg.js";import{f as Rt,m as ze,h as Ue,i as Mt,j as Je,k as qt,s as Bt,g as xe,c as Qe,d as Vt,C as Ut,a as Ht,P as Qt,e as K,u as Wt,o as xt}from"../chunks/pqZsTTMp.js";import{I as Ft}from"../chunks/ucg5DYzH.js";import{t as zt,c as Jt,r as Xt,g as Kt,S as Zt}from"../chunks/BNflJat_.js";import{o as Gt,c as Yt}from"../chunks/f-iGVwm8.js";import{d as Xe,w as $t}from"../chunks/3WS7gtyC.js";import{B as el}from"../chunks/dIJLHdEI.js";const tl=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ll={disabled:!1,required:!1,name:void 0,value:"on",defaultChecked:!1};function rl(s){const e={...ll,...s},l=zt(Rt(e,"checked","defaultChecked")),{disabled:t,name:r,required:i,value:n}=l,a=e.checked??$t(e.defaultChecked),o=Gt(a,e==null?void 0:e.onCheckedChange),h=ze("checkbox",{stores:[o,t,i],returned:([d,f,c])=>({"data-disabled":Ue(f),disabled:Ue(f),"data-state":d==="indeterminate"?"indeterminate":d?"checked":"unchecked",type:"button",role:"checkbox","aria-checked":d==="indeterminate"?"mixed":d,"aria-required":c}),action:d=>({destroy:Mt(Je(d,"keydown",c=>{c.key===qt.ENTER&&c.preventDefault()}),Je(d,"click",()=>{t.get()||o.update(c=>c==="indeterminate"?!0:!c)}))})}),b=ze("checkbox-input",{stores:[o,r,n,i,t],returned:([d,f,c,u,C])=>({type:"checkbox","aria-hidden":!0,hidden:!0,tabindex:-1,name:f,value:c,checked:d==="indeterminate"?!1:d,required:u,disabled:Ue(C),style:Bt({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"})})}),_=Xe(o,d=>d==="indeterminate"),m=Xe(o,d=>d===!0);return{elements:{root:h,input:b},states:{checked:o},helpers:{isIndeterminate:_,isChecked:m},options:l}}function Et(){return{NAME:"checkbox",PARTS:["root","input","indicator"]}}function sl(s){const{NAME:e,PARTS:l}=Et(),t=Jt(e,l),r={...rl(Xt(s)),getAttrs:t};return It(e,r),{...r,updateOption:Kt(r.options)}}function nl(){const{NAME:s}=Et();return Nt(s)}const il=s=>({builder:s&4}),Ke=s=>({builder:s[2]}),ol=s=>({builder:s&4}),Ze=s=>({builder:s[2]});function al(s){let e,l,t,r;const i=s[15].default,n=Ae(i,s,s[14],Ke);let a=[s[2],{type:"button"},s[5]],o={};for(let h=0;h<a.length;h+=1)o=fe(o,a[h]);return{c(){e=P("button"),n&&n.c(),this.h()},l(h){e=T(h,"BUTTON",{type:!0});var b=L(e);n&&n.l(b),b.forEach(g),this.h()},h(){Ce(e,o)},m(h,b){I(h,e,b),n&&n.m(e,null),e.autofocus&&e.focus(),s[16](e),l=!0,t||(r=[Lt(s[2].action(e)),He(e,"m-click",s[4]),He(e,"m-keydown",s[4])],t=!0)},p(h,b){n&&n.p&&(!l||b&16388)&&Ie(n,i,h,h[14],l?Le(i,h[14],b,il):Ne(h[14]),Ke),Ce(e,o=xe(a,[b&4&&h[2],{type:"button"},b&32&&h[5]]))},i(h){l||(D(n,h),l=!0)},o(h){M(n,h),l=!1},d(h){h&&g(e),n&&n.d(h),s[16](null),t=!1,jt(r)}}}function cl(s){let e;const l=s[15].default,t=Ae(l,s,s[14],Ze);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,i){t&&t.m(r,i),e=!0},p(r,i){t&&t.p&&(!e||i&16388)&&Ie(t,l,r,r[14],e?Le(l,r[14],i,ol):Ne(r[14]),Ze)},i(r){e||(D(t,r),e=!0)},o(r){M(t,r),e=!1},d(r){t&&t.d(r)}}}function fl(s){let e,l,t,r;const i=[cl,al],n=[];function a(o,h){return o[1]?0:1}return e=a(s),l=n[e]=i[e](s),{c(){l.c(),t=x()},l(o){l.l(o),t=x()},m(o,h){n[e].m(o,h),I(o,t,h),r=!0},p(o,[h]){let b=e;e=a(o),e===b?n[e].p(o,h):(ue(),M(n[b],1,1,()=>{n[b]=null}),de(),l=n[e],l?l.p(o,h):(l=n[e]=i[e](o),l.c()),D(l,1),l.m(t.parentNode,t))},i(o){r||(D(l),r=!0)},o(o){M(l),r=!1},d(o){o&&g(t),n[e].d(o)}}}function ul(s,e,l){let t,r;const i=["checked","disabled","name","required","value","onCheckedChange","asChild","el"];let n=ge(e,i),a,{$$slots:o={},$$scope:h}=e,{checked:b=!1}=e,{disabled:_=void 0}=e,{name:m=void 0}=e,{required:d=void 0}=e,{value:f=void 0}=e,{onCheckedChange:c=void 0}=e,{asChild:u=!1}=e,{el:C=void 0}=e;const{elements:{root:w},states:{checked:E},updateOption:N,getAttrs:O}=sl({defaultChecked:b,disabled:_,name:m,required:d,value:f,onCheckedChange:({next:v})=>(b!==v&&(c==null||c(v),l(6,b=v)),v)});we(s,w,v=>l(13,a=v));const B=Yt();function j(v){Te[v?"unshift":"push"](()=>{C=v,l(0,C)})}return s.$$set=v=>{e=fe(fe({},e),We(v)),l(5,n=ge(e,i)),"checked"in v&&l(6,b=v.checked),"disabled"in v&&l(7,_=v.disabled),"name"in v&&l(8,m=v.name),"required"in v&&l(9,d=v.required),"value"in v&&l(10,f=v.value),"onCheckedChange"in v&&l(11,c=v.onCheckedChange),"asChild"in v&&l(1,u=v.asChild),"el"in v&&l(0,C=v.el),"$$scope"in v&&l(14,h=v.$$scope)},s.$$.update=()=>{s.$$.dirty&128&&l(12,t={...O("root"),disabled:_?!0:void 0}),s.$$.dirty&64&&b!==void 0&&E.set(b),s.$$.dirty&128&&N("disabled",_),s.$$.dirty&256&&N("name",m),s.$$.dirty&512&&N("required",d),s.$$.dirty&1024&&N("value",f),s.$$.dirty&8192&&l(2,r=a),s.$$.dirty&4100&&Object.assign(r,t)},[C,u,r,w,B,n,b,_,m,d,f,c,t,a,h,o,j]}let dl=class extends Oe{constructor(e){super(),Re(this,e,ul,fl,Pe,{checked:6,disabled:7,name:8,required:9,value:10,onCheckedChange:11,asChild:1,el:0})}};const hl=s=>({attrs:s&4,isChecked:s&8,isIndeterminate:s&16}),Ge=s=>({attrs:s[2],isChecked:s[3],isIndeterminate:s[4]}),ml=s=>({attrs:s&4,isChecked:s&8,isIndeterminate:s&16}),Ye=s=>({attrs:s[2],isChecked:s[3],isIndeterminate:s[4]});function _l(s){let e,l;const t=s[11].default,r=Ae(t,s,s[10],Ge);let i=[s[8],s[2]],n={};for(let a=0;a<i.length;a+=1)n=fe(n,i[a]);return{c(){e=P("div"),r&&r.c(),this.h()},l(a){e=T(a,"DIV",{});var o=L(e);r&&r.l(o),o.forEach(g),this.h()},h(){Ce(e,n)},m(a,o){I(a,e,o),r&&r.m(e,null),s[12](e),l=!0},p(a,o){r&&r.p&&(!l||o&1052)&&Ie(r,t,a,a[10],l?Le(t,a[10],o,hl):Ne(a[10]),Ge),Ce(e,n=xe(i,[o&256&&a[8],o&4&&a[2]]))},i(a){l||(D(r,a),l=!0)},o(a){M(r,a),l=!1},d(a){a&&g(e),r&&r.d(a),s[12](null)}}}function bl(s){let e;const l=s[11].default,t=Ae(l,s,s[10],Ye);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,i){t&&t.m(r,i),e=!0},p(r,i){t&&t.p&&(!e||i&1052)&&Ie(t,l,r,r[10],e?Le(l,r[10],i,ml):Ne(r[10]),Ye)},i(r){e||(D(t,r),e=!0)},o(r){M(t,r),e=!1},d(r){t&&t.d(r)}}}function gl(s){let e,l,t,r;const i=[bl,_l],n=[];function a(o,h){return o[1]?0:1}return e=a(s),l=n[e]=i[e](s),{c(){l.c(),t=x()},l(o){l.l(o),t=x()},m(o,h){n[e].m(o,h),I(o,t,h),r=!0},p(o,[h]){let b=e;e=a(o),e===b?n[e].p(o,h):(ue(),M(n[b],1,1,()=>{n[b]=null}),de(),l=n[e],l?l.p(o,h):(l=n[e]=i[e](o),l.c()),D(l,1),l.m(t.parentNode,t))},i(o){r||(D(l),r=!0)},o(o){M(l),r=!1},d(o){o&&g(t),n[e].d(o)}}}function pl(s){return s==="indeterminate"?"indeterminate":s?"checked":"unchecked"}function kl(s,e,l){let t;const r=["asChild","el"];let i=ge(e,r),n,a,o,{$$slots:h={},$$scope:b}=e,{asChild:_=!1}=e,{el:m=void 0}=e;const{helpers:{isChecked:d,isIndeterminate:f},states:{checked:c},getAttrs:u}=nl();we(s,d,w=>l(3,a=w)),we(s,f,w=>l(4,o=w)),we(s,c,w=>l(9,n=w));function C(w){Te[w?"unshift":"push"](()=>{m=w,l(0,m)})}return s.$$set=w=>{e=fe(fe({},e),We(w)),l(8,i=ge(e,r)),"asChild"in w&&l(1,_=w.asChild),"el"in w&&l(0,m=w.el),"$$scope"in w&&l(10,b=w.$$scope)},s.$$.update=()=>{s.$$.dirty&512&&l(2,t={...u("indicator"),"data-state":pl(n)})},[m,_,t,a,o,d,f,c,i,n,b,h,C]}class vl extends Oe{constructor(e){super(),Re(this,e,kl,gl,Pe,{asChild:1,el:0})}}function $e(s){let e,l;return e=new vl({props:{class:Qe("flex items-center justify-center text-current pointer-events-none"),$$slots:{default:[yl]},$$scope:{ctx:s}}}),{c(){ie(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){ae(e,t,r),l=!0},i(t){l||(D(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){ce(e,t)}}}function yl(s){let e,l;return{c(){e=Ee("svg"),l=Ee("polyline"),this.h()},l(t){e=Se(t,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var r=L(e);l=Se(r,"polyline",{points:!0}),L(l).forEach(g),r.forEach(g),this.h()},h(){p(l,"points","20 6 9 17 4 12"),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"viewBox","0 0 24 24"),p(e,"fill","none"),p(e,"stroke","currentColor"),p(e,"stroke-width","2"),p(e,"stroke-linecap","round"),p(e,"stroke-linejoin","round"),p(e,"class","h-4 w-4 pointer-events-none")},m(t,r){I(t,e,r),y(e,l)},p:z,d(t){t&&g(e)}}}function wl(s){let e,l,t=s[0]&&$e(s);return{c(){t&&t.c(),e=x()},l(r){t&&t.l(r),e=x()},m(r,i){t&&t.m(r,i),I(r,e,i),l=!0},p(r,i){r[0]?t?i&1&&D(t,1):(t=$e(r),t.c(),D(t,1),t.m(e.parentNode,e)):t&&(ue(),M(t,1,1,()=>{t=null}),de())},i(r){l||(D(t),l=!0)},o(r){M(t),l=!1},d(r){r&&g(e),t&&t.d(r)}}}function Cl(s){let e,l,t;const r=[{class:Qe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s[1])},s[2]];function i(a){s[3](a)}let n={$$slots:{default:[wl]},$$scope:{ctx:s}};for(let a=0;a<r.length;a+=1)n=fe(n,r[a]);return s[0]!==void 0&&(n.checked=s[0]),e=new dl({props:n}),Te.push(()=>Ct(e,"checked",i)),{c(){ie(e.$$.fragment)},l(a){oe(e.$$.fragment,a)},m(a,o){ae(e,a,o),t=!0},p(a,[o]){const h=o&6?xe(r,[o&2&&{class:Qe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a[1])},o&4&&Vt(a[2])]):{};o&17&&(h.$$scope={dirty:o,ctx:a}),!l&&o&1&&(l=!0,h.checked=a[0],wt(()=>l=!1)),e.$set(h)},i(a){t||(D(e.$$.fragment,a),t=!0)},o(a){M(e.$$.fragment,a),t=!1},d(a){ce(e,a)}}}function El(s,e,l){const t=["class","checked"];let r=ge(e,t),{class:i=void 0}=e,{checked:n=!1}=e;function a(o){n=o,l(0,n)}return s.$$set=o=>{e=fe(fe({},e),We(o)),l(2,r=ge(e,t)),"class"in o&&l(1,i=o.class),"checked"in o&&l(0,n=o.checked)},[n,i,r,a]}class Sl extends Oe{constructor(e){super(),Re(this,e,El,Cl,Pe,{class:1,checked:0})}}const{Map:Pl}=tl;function et(s,e,l){const t=s.slice();return t[37]=e[l],t}function tt(s,e,l){const t=s.slice();return t[40]=e[l],t}function lt(s,e,l){const t=s.slice();return t[43]=e[l],t}function rt(s,e,l){const t=s.slice();return t[46]=e[l],t}function st(s,e,l){const t=s.slice();return t[50]=e[l],t}function nt(s,e,l){const t=s.slice();return t[53]=e[l],t}function Tl(s){const e=s.slice(),l=[...new Set(e[6].filter(t=>!t.label.match(/^Q\d+$/)).map(t=>t.relation))];return e[49]=l,e}function Al(s){let e,l,t="Discover objects while leveraging semantic search with Wikidata";return{c(){e=J(`Enhanced Semantic Search\r
                `),l=P("small"),l.textContent=t,this.h()},l(r){e=X(r,`Enhanced Semantic Search\r
                `),l=T(r,"SMALL",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-1fmc079"&&(l.textContent=t),this.h()},h(){p(l,"class","block text-sm mt-2 font-normal opacity-75")},m(r,i){I(r,e,i),I(r,l,i)},p:z,d(r){r&&(g(e),g(l))}}}function Il(s){let e,l,t="Related Terms from Wikidata:",r,i,n,a,o;const h=[jl,Ll],b=[];function _(f,c){return f[6].length>0?0:1}function m(f,c){return c===0?Tl(f):f}i=_(s),n=b[i]=h[i](m(s,i));let d=s[2].length>0&&ft(s);return{c(){e=P("div"),l=P("h3"),l.textContent=t,r=V(),n.c(),a=V(),d&&d.c(),this.h()},l(f){e=T(f,"DIV",{class:!0});var c=L(e);l=T(c,"H3",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-1urvpeo"&&(l.textContent=t),r=U(c),n.l(c),a=U(c),d&&d.l(c),c.forEach(g),this.h()},h(){p(l,"class","text-sm font-semibold mb-2"),p(e,"class","mb-6 bg-neutral-50 dark:bg-neutral-900 p-4 rounded-lg")},m(f,c){I(f,e,c),y(e,l),y(e,r),b[i].m(e,null),y(e,a),d&&d.m(e,null),o=!0},p(f,c){let u=i;i=_(f),i===u?b[i].p(m(f,i),c):(ue(),M(b[u],1,1,()=>{b[u]=null}),de(),n=b[i],n?n.p(m(f,i),c):(n=b[i]=h[i](m(f,i)),n.c()),D(n,1),n.m(e,a)),f[2].length>0?d?(d.p(f,c),c[0]&4&&D(d,1)):(d=ft(f),d.c(),D(d,1),d.m(e,null)):d&&(ue(),M(d,1,1,()=>{d=null}),de())},i(f){o||(D(n),D(d),o=!0)},o(f){M(n),M(d),o=!1},d(f){f&&g(e),b[i].d(),d&&d.d()}}}function Nl(s){let e,l='<div class="w-8 h-8 border-2 border-rose-900 border-t-transparent rounded-full animate-spin" aria-label="Loading related terms"></div> <span class="ml-2">Finding related terms...</span>';return{c(){e=P("div"),e.innerHTML=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1njf8x0"&&(e.innerHTML=l),this.h()},h(){p(e,"class","flex justify-center my-4")},m(t,r){I(t,e,r)},p:z,i:z,o:z,d(t){t&&g(e)}}}function Ll(s){let e,l="No related terms found.";return{c(){e=P("p"),e.textContent=l,this.h()},l(t){e=T(t,"P",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1ng5y2l"&&(e.textContent=l),this.h()},h(){p(e,"class","text-sm text-neutral-500")},m(t,r){I(t,e,r)},p:z,i:z,o:z,d(t){t&&g(e)}}}function jl(s){let e,l,t=K(s[49]),r=[];for(let n=0;n<t.length;n+=1)r[n]=ct(st(s,t,n));const i=n=>M(r[n],1,1,()=>{r[n]=null});return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=x()},l(n){for(let a=0;a<r.length;a+=1)r[a].l(n);e=x()},m(n,a){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,a);I(n,e,a),l=!0},p(n,a){if(a[0]&3136){t=K(n[49]);let o;for(o=0;o<t.length;o+=1){const h=st(n,t,o);r[o]?(r[o].p(h,a),D(r[o],1)):(r[o]=ct(h),r[o].c(),D(r[o],1),r[o].m(e.parentNode,e))}for(ue(),o=t.length;o<r.length;o+=1)i(o);de()}},i(n){if(!l){for(let a=0;a<t.length;a+=1)D(r[a]);l=!0}},o(n){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)M(r[a]);l=!1},d(n){n&&g(e),ye(r,n)}}}function Dl(s){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(t){e=Se(t,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var r=L(e);l=Se(r,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0}),L(l).forEach(g),r.forEach(g),this.h()},h(){p(l,"d","M13.3334 4L6.00002 11.3333L2.66669 8"),p(l,"stroke","white"),p(l,"stroke-width","2"),p(l,"stroke-linecap","round"),p(l,"stroke-linejoin","round"),p(e,"width","16"),p(e,"height","16"),p(e,"viewBox","0 0 16 16"),p(e,"fill","none"),p(e,"xmlns","http://www.w3.org/2000/svg")},m(t,r){I(t,e,r),y(e,l)},p:z,d(t){t&&g(e)}}}function Ol(s){let e,l;return e=new(void 0)({props:{$$slots:{default:[Dl]},$$scope:{ctx:s}}}),{c(){ie(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){ae(e,t,r),l=!0},p(t,r){const i={};r[1]&33554432&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(t){l||(D(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){ce(e,t)}}}function it(s){let e,l="â˜…";return{c(){e=P("span"),e.textContent=l,this.h()},l(t){e=T(t,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1y73axa"&&(e.textContent=l),this.h()},h(){p(e,"class","ml-1 text-rose-600 dark:text-rose-400 text-xs")},m(t,r){I(t,e,r)},d(t){t&&g(e)}}}function ot(s){let e,l="(previous)";return{c(){e=P("span"),e.textContent=l,this.h()},l(t){e=T(t,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1pt3e5b"&&(e.textContent=l),this.h()},h(){p(e,"class","ml-1 text-rose-600 dark:text-rose-400 text-xs")},m(t,r){I(t,e,r)},d(t){t&&g(e)}}}function at(s,e){let l,t,r,i,n,a,o=e[53].label+"",h,b,_,m,d,f;function c(){return e[24](e[53])}r=new Sl({props:{checked:e[11](e[53]),onCheckedChange:c,class:"data-[state=checked]:bg-rose-600",$$slots:{default:[Ol]},$$scope:{ctx:e}}});let u=e[53].score>70&&it(),C=e[53].fromPreviousSearch&&ot();return{key:s,first:null,c(){l=P("div"),t=P("label"),ie(r.$$.fragment),i=V(),n=P("span"),a=P("span"),h=J(o),b=V(),u&&u.c(),_=V(),C&&C.c(),d=V(),this.h()},l(w){l=T(w,"DIV",{class:!0});var E=L(l);t=T(E,"LABEL",{class:!0,title:!0});var N=L(t);oe(r.$$.fragment,N),i=U(N),n=T(N,"SPAN",{class:!0});var O=L(n);a=T(O,"SPAN",{class:!0});var B=L(a);h=X(B,o),B.forEach(g),b=U(O),u&&u.l(O),_=U(O),C&&C.l(O),O.forEach(g),N.forEach(g),d=U(E),E.forEach(g),this.h()},h(){p(a,"class","font-medium"),p(n,"class","text-xs"),p(t,"class","flex items-center space-x-2 px-2 py-1 bg-white dark:bg-neutral-800 rounded border border-neutral-200 dark:border-neutral-700 cursor-pointer hover:bg-neutral-100 dark:hover:bg-neutral-700"),p(t,"title",m=`Relevance: ${e[53].score>80?"High":e[53].score>50?"Medium":"Low"}`),F(t,"border-rose-500",e[53].fromPreviousSearch),F(t,"bg-rose-50",e[53].fromPreviousSearch&&!e[11](e[53])),F(t,"dark:bg-rose-900",e[53].fromPreviousSearch&&!e[11](e[53])),F(t,"bg-opacity-30",e[53].fromPreviousSearch),F(t,"border-l-4",e[53].score>70),F(t,"border-l-rose-600",e[53].score>70),p(l,"class","flex items-center"),this.first=l},m(w,E){I(w,l,E),y(l,t),ae(r,t,null),y(t,i),y(t,n),y(n,a),y(a,h),y(n,b),u&&u.m(n,null),y(n,_),C&&C.m(n,null),y(l,d),f=!0},p(w,E){e=w;const N={};E[0]&64&&(N.checked=e[11](e[53])),E[0]&64&&(N.onCheckedChange=c),E[1]&33554432&&(N.$$scope={dirty:E,ctx:e}),r.$set(N),(!f||E[0]&64)&&o!==(o=e[53].label+"")&&ve(h,o),e[53].score>70?u||(u=it(),u.c(),u.m(n,_)):u&&(u.d(1),u=null),e[53].fromPreviousSearch?C||(C=ot(),C.c(),C.m(n,null)):C&&(C.d(1),C=null),(!f||E[0]&64&&m!==(m=`Relevance: ${e[53].score>80?"High":e[53].score>50?"Medium":"Low"}`))&&p(t,"title",m),(!f||E[0]&64)&&F(t,"border-rose-500",e[53].fromPreviousSearch),(!f||E[0]&2112)&&F(t,"bg-rose-50",e[53].fromPreviousSearch&&!e[11](e[53])),(!f||E[0]&2112)&&F(t,"dark:bg-rose-900",e[53].fromPreviousSearch&&!e[11](e[53])),(!f||E[0]&64)&&F(t,"bg-opacity-30",e[53].fromPreviousSearch),(!f||E[0]&64)&&F(t,"border-l-4",e[53].score>70),(!f||E[0]&64)&&F(t,"border-l-rose-600",e[53].score>70)},i(w){f||(D(r.$$.fragment,w),f=!0)},o(w){M(r.$$.fragment,w),f=!1},d(w){w&&g(l),ce(r),u&&u.d(),C&&C.d()}}}function ct(s){let e,l,t=s[50]+"",r,i,n,a,o=[],h=new Pl,b,_;function m(...c){return s[23](s[50],...c)}let d=K(s[6].filter(m));const f=c=>c[53].id;for(let c=0;c<d.length;c+=1){let u=nt(s,d,c),C=f(u);h.set(C,o[c]=at(C,u))}return{c(){e=P("div"),l=P("h4"),r=J(t),i=J(":"),n=V(),a=P("div");for(let c=0;c<o.length;c+=1)o[c].c();b=V(),this.h()},l(c){e=T(c,"DIV",{class:!0});var u=L(e);l=T(u,"H4",{class:!0});var C=L(l);r=X(C,t),i=X(C,":"),C.forEach(g),n=U(u),a=T(u,"DIV",{class:!0});var w=L(a);for(let E=0;E<o.length;E+=1)o[E].l(w);w.forEach(g),b=U(u),u.forEach(g),this.h()},h(){p(l,"class","text-xs text-neutral-500 mb-1 capitalize"),p(a,"class","flex flex-wrap gap-2"),p(e,"class","mb-3")},m(c,u){I(c,e,u),y(e,l),y(l,r),y(l,i),y(e,n),y(e,a);for(let C=0;C<o.length;C+=1)o[C]&&o[C].m(a,null);y(e,b),_=!0},p(c,u){s=c,(!_||u[0]&64)&&t!==(t=s[50]+"")&&ve(r,t),u[0]&3136&&(d=K(s[6].filter(m)),ue(),o=Wt(o,u,f,1,s,d,h,a,xt,at,null,nt),de())},i(c){if(!_){for(let u=0;u<d.length;u+=1)D(o[u]);_=!0}},o(c){for(let u=0;u<o.length;u+=1)M(o[u]);_=!1},d(c){c&&g(e);for(let u=0;u<o.length;u+=1)o[u].d()}}}function ft(s){let e,l,t,r,i,n,a,o,h,b=K(s[2]),_=[];for(let m=0;m<b.length;m+=1)_[m]=ut(rt(s,b,m));return o=new el({props:{variant:"ghost",size:"sm",class:"text-xs hover:bg-rose-900 hover:text-white",$$slots:{default:[Rl]},$$scope:{ctx:s}}}),o.$on("click",s[25]),{c(){e=P("div"),l=P("p"),t=J("Searching for: "),r=P("span"),i=J(s[0]),n=V();for(let m=0;m<_.length;m+=1)_[m].c();a=V(),ie(o.$$.fragment),this.h()},l(m){e=T(m,"DIV",{class:!0});var d=L(e);l=T(d,"P",{class:!0});var f=L(l);t=X(f,"Searching for: "),r=T(f,"SPAN",{class:!0});var c=L(r);i=X(c,s[0]),c.forEach(g),n=U(f);for(let u=0;u<_.length;u+=1)_[u].l(f);f.forEach(g),a=U(d),oe(o.$$.fragment,d),d.forEach(g),this.h()},h(){p(r,"class","font-semibold"),p(l,"class","text-xs text-neutral-500"),p(e,"class","mt-2 flex items-center justify-between")},m(m,d){I(m,e,d),y(e,l),y(l,t),y(l,r),y(r,i),y(l,n);for(let f=0;f<_.length;f+=1)_[f]&&_[f].m(l,null);y(e,a),ae(o,e,null),h=!0},p(m,d){if((!h||d[0]&1)&&ve(i,m[0]),d[0]&4){b=K(m[2]);let c;for(c=0;c<b.length;c+=1){const u=rt(m,b,c);_[c]?_[c].p(u,d):(_[c]=ut(u),_[c].c(),_[c].m(l,null))}for(;c<_.length;c+=1)_[c].d(1);_.length=b.length}const f={};d[1]&33554432&&(f.$$scope={dirty:d,ctx:m}),o.$set(f)},i(m){h||(D(o.$$.fragment,m),h=!0)},o(m){M(o.$$.fragment,m),h=!1},d(m){m&&g(e),ye(_,m),ce(o)}}}function ut(s){let e,l="OR",t,r,i=s[46].label+"",n;return{c(){e=P("span"),e.textContent=l,t=V(),r=P("span"),n=J(i),this.h()},l(a){e=T(a,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-13x4cq7"&&(e.textContent=l),t=U(a),r=T(a,"SPAN",{class:!0});var o=L(r);n=X(o,i),o.forEach(g),this.h()},h(){p(e,"class","mx-1"),p(r,"class","font-semibold")},m(a,o){I(a,e,o),I(a,t,o),I(a,r,o),y(r,n)},p(a,o){o[0]&4&&i!==(i=a[46].label+"")&&ve(n,i)},d(a){a&&(g(e),g(t),g(r))}}}function Rl(s){let e;return{c(){e=J("Clear All")},l(l){e=X(l,"Clear All")},m(l,t){I(l,e,t)},d(l){l&&g(e)}}}function Ml(s){let e,l=K(s[3]),t=[];for(let r=0;r<l.length;r+=1)t[r]=vt(et(s,l,r));return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=x()},l(r){for(let i=0;i<t.length;i+=1)t[i].l(r);e=x()},m(r,i){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(r,i);I(r,e,i)},p(r,i){if(i[0]&12680){l=K(r[3]);let n;for(n=0;n<l.length;n+=1){const a=et(r,l,n);t[n]?t[n].p(a,i):(t[n]=vt(a),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=l.length}},d(r){r&&g(e),ye(t,r)}}}function ql(s){let e,l='<p class="text-gray-500">Type at least 3 characters to search</p>';return{c(){e=P("div"),e.innerHTML=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-123cmei"&&(e.innerHTML=l),this.h()},h(){p(e,"class","text-center p-4")},m(t,r){I(t,e,r)},p:z,d(t){t&&g(e)}}}function Bl(s){let e,l='<p class="text-gray-500">No results found</p>';return{c(){e=P("div"),e.innerHTML=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1x211b9"&&(e.innerHTML=l),this.h()},h(){p(e,"class","text-center p-4")},m(t,r){I(t,e,r)},p:z,d(t){t&&g(e)}}}function Vl(s){let e,l='<div class="w-8 h-8 border-2 border-rose-900 border-t-transparent rounded-full animate-spin mx-auto mb-2" aria-hidden="true"></div> <p>Searching...</p>';return{c(){e=P("div"),e.innerHTML=l,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-18mrj6l"&&(e.innerHTML=l),this.h()},h(){p(e,"class","text-center p-4")},m(t,r){I(t,e,r)},p:z,d(t){t&&g(e)}}}function dt(s){let e,l="Solved";return{c(){e=P("span"),e.textContent=l,this.h()},l(t){e=T(t,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-qjjcg8"&&(e.textContent=l),this.h()},h(){p(e,"class","bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100 text-xs px-2 py-1 rounded-full font-medium")},m(t,r){I(t,e,r)},d(t){t&&g(e)}}}function ht(s){let e,l,t=s[12](s[37].description)+"";return{c(){e=P("p"),l=new je(!1),this.h()},l(r){e=T(r,"P",{class:!0});var i=L(e);l=De(i,!1),i.forEach(g),this.h()},h(){l.a=null,p(e,"class","text-sm text-gray-600 dark:text-gray-300 mb-2")},m(r,i){I(r,e,i),l.m(t,e)},p(r,i){i[0]&8&&t!==(t=r[12](r[37].description)+"")&&l.p(t)},d(r){r&&g(e)}}}function mt(s){let e,l,t=K(s[7]),r=[];for(let i=0;i<t.length;i+=1)r[i]=bt(lt(s,t,i));return{c(){e=P("div"),l=P("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=T(i,"DIV",{class:!0});var n=L(e);l=T(n,"DIV",{class:!0});var a=L(l);for(let o=0;o<r.length;o+=1)r[o].l(a);a.forEach(g),n.forEach(g),this.h()},h(){p(l,"class","space-y-1.5"),p(e,"class","mt-3 text-sm")},m(i,n){I(i,e,n),y(e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,null)},p(i,n){if(n[0]&4488){t=K(i[7]);let a;for(a=0;a<t.length;a+=1){const o=lt(i,t,a);r[a]?r[a].p(o,n):(r[a]=bt(o),r[a].c(),r[a].m(l,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(i){i&&g(e),ye(r,i)}}}function _t(s){let e,l,t=s[43].label+"",r,i,n,a,o,h=s[12](s[37].mysteryObject[s[43].key])+"",b;return{c(){e=P("div"),l=P("span"),r=J(t),i=J(":"),n=V(),a=P("span"),o=new je(!1),b=V(),this.h()},l(_){e=T(_,"DIV",{class:!0});var m=L(e);l=T(m,"SPAN",{class:!0});var d=L(l);r=X(d,t),i=X(d,":"),d.forEach(g),n=U(m),a=T(m,"SPAN",{class:!0});var f=L(a);o=De(f,!1),f.forEach(g),b=U(m),m.forEach(g),this.h()},h(){p(l,"class","font-medium text-gray-700 dark:text-gray-300"),o.a=null,p(a,"class","text-gray-800 dark:text-gray-200"),p(e,"class","bg-gray-50 dark:bg-gray-800 p-2 rounded")},m(_,m){I(_,e,m),y(e,l),y(l,r),y(l,i),y(e,n),y(e,a),o.m(h,a),y(e,b)},p(_,m){m[0]&8&&h!==(h=_[12](_[37].mysteryObject[_[43].key])+"")&&o.p(h)},d(_){_&&g(e)}}}function bt(s){let e=s[37].mysteryObject[s[43].key]&&s[8](s[37].mysteryObject[s[43].key]),l,t=e&&_t(s);return{c(){t&&t.c(),l=x()},l(r){t&&t.l(r),l=x()},m(r,i){t&&t.m(r,i),I(r,l,i)},p(r,i){i[0]&8&&(e=r[37].mysteryObject[r[43].key]&&r[8](r[37].mysteryObject[r[43].key])),e?t?t.p(r,i):(t=_t(r),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},d(r){r&&g(l),t&&t.d(r)}}}function gt(s){let e,l=K(s[37].tags),t=[];for(let r=0;r<l.length;r+=1)t[r]=kt(tt(s,l,r));return{c(){e=P("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=T(r,"DIV",{class:!0});var i=L(e);for(let n=0;n<t.length;n+=1)t[n].l(i);i.forEach(g),this.h()},h(){p(e,"class","flex gap-1 flex-wrap")},m(r,i){I(r,e,i);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(r,i){if(i[0]&12296){l=K(r[37].tags);let n;for(n=0;n<l.length;n+=1){const a=tt(r,l,n);t[n]?t[n].p(a,i):(t[n]=kt(a),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=l.length}},d(r){r&&g(e),ye(t,r)}}}function pt(s){let e,l,t=s[12](s[13](s[40]))+"",r;return{c(){e=P("span"),l=new je(!1),r=V(),this.h()},l(i){e=T(i,"SPAN",{class:!0});var n=L(e);l=De(n,!1),r=U(n),n.forEach(g),this.h()},h(){l.a=r,p(e,"class","bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded")},m(i,n){I(i,e,n),l.m(t,e),y(e,r)},p(i,n){n[0]&8&&t!==(t=i[12](i[13](i[40]))+"")&&l.p(t)},d(i){i&&g(e)}}}function kt(s){let e,l=s[40]&&pt(s);return{c(){l&&l.c(),e=x()},l(t){l&&l.l(t),e=x()},m(t,r){l&&l.m(t,r),I(t,e,r)},p(t,r){t[40]?l?l.p(t,r):(l=pt(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&g(e),l&&l.d(t)}}}function vt(s){let e,l,t,r,i=s[12](s[37].title||"")+"",n,a,o,h,b,_,m,d=(s[37].author||"Anonymous")+"",f,c,u=s[37].tags&&Array.isArray(s[37].tags)&&s[37].tags.length>0,C,w,E=s[37].isSolved&&dt(),N=s[37].description&&ht(s),O=s[37].mysteryObject&&mt(s),B=u&&gt(s);return{c(){e=P("a"),l=P("div"),t=P("h2"),r=new je(!1),n=V(),E&&E.c(),a=V(),N&&N.c(),o=V(),O&&O.c(),h=V(),b=P("div"),_=P("p"),m=J("Posted by: "),f=J(d),c=V(),B&&B.c(),C=V(),this.h()},l(j){e=T(j,"A",{href:!0,class:!0});var v=L(e);l=T(v,"DIV",{class:!0});var W=L(l);t=T(W,"H2",{class:!0});var te=L(t);r=De(te,!1),te.forEach(g),n=U(W),E&&E.l(W),W.forEach(g),a=U(v),N&&N.l(v),o=U(v),O&&O.l(v),h=U(v),b=T(v,"DIV",{class:!0});var le=L(b);_=T(le,"P",{class:!0});var $=L(_);m=X($,"Posted by: "),f=X($,d),$.forEach(g),c=U(le),B&&B.l(le),le.forEach(g),C=U(v),v.forEach(g),this.h()},h(){r.a=null,p(t,"class","text-xl font-semibold mb-2"),p(l,"class","flex justify-between items-start"),p(_,"class","text-gray-500"),p(b,"class","flex justify-between items-center mt-3 text-xs"),p(e,"href",w=`/thread/${s[37].id}`),p(e,"class","block p-4 border rounded-lg hover:border-rose-900 transition-colors duration-200")},m(j,v){I(j,e,v),y(e,l),y(l,t),r.m(i,t),y(l,n),E&&E.m(l,null),y(e,a),N&&N.m(e,null),y(e,o),O&&O.m(e,null),y(e,h),y(e,b),y(b,_),y(_,m),y(_,f),y(b,c),B&&B.m(b,null),y(e,C)},p(j,v){v[0]&8&&i!==(i=j[12](j[37].title||"")+"")&&r.p(i),j[37].isSolved?E||(E=dt(),E.c(),E.m(l,null)):E&&(E.d(1),E=null),j[37].description?N?N.p(j,v):(N=ht(j),N.c(),N.m(e,o)):N&&(N.d(1),N=null),j[37].mysteryObject?O?O.p(j,v):(O=mt(j),O.c(),O.m(e,h)):O&&(O.d(1),O=null),v[0]&8&&d!==(d=(j[37].author||"Anonymous")+"")&&ve(f,d),v[0]&8&&(u=j[37].tags&&Array.isArray(j[37].tags)&&j[37].tags.length>0),u?B?B.p(j,v):(B=gt(j),B.c(),B.m(b,null)):B&&(B.d(1),B=null),v[0]&8&&w!==(w=`/thread/${j[37].id}`)&&p(e,"href",w)},d(j){j&&g(e),E&&E.d(),N&&N.d(),O&&O.d(),B&&B.d()}}}function Ul(s){let e,l,t,r,i,n,a,o,h="Search",b,_,m,d,f,c,u,C,w,E,N,O;e=new Ht({props:{class:"p-4 text-2xl mt-6 text-center",$$slots:{default:[Al]},$$scope:{ctx:s}}});function B(A){s[22](A)}let j={type:"search",placeholder:"Enter search terms...",class:"w-full","aria-label":"Search terms"};s[0]!==void 0&&(j.value=s[0]),i=new Ft({props:j}),Te.push(()=>Ct(i,"value",B));const v=[Nl,Il],W=[];function te(A,q){return A[1]?0:A[5]?1:-1}~(_=te(s))&&(m=W[_]=v[_](s)),f=new Zt({props:{class:"my-6"}});function le(A,q){return q[0]&9&&(C=null),q[0]&1&&(w=null),A[4]?Vl:(C==null&&(C=A[3].length===0&&A[0].trim().length>=3),C?Bl:(w==null&&(w=A[0].trim().length<3),w?ql:Ml))}let $=le(s,[-1,-1]),Q=$(s);return{c(){ie(e.$$.fragment),l=V(),t=P("div"),r=P("form"),ie(i.$$.fragment),a=V(),o=P("button"),o.textContent=h,b=V(),m&&m.c(),d=V(),ie(f.$$.fragment),c=V(),u=P("div"),Q.c(),this.h()},l(A){oe(e.$$.fragment,A),l=U(A),t=T(A,"DIV",{class:!0});var q=L(t);r=T(q,"FORM",{class:!0});var re=L(r);oe(i.$$.fragment,re),a=U(re),o=T(re,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-efa4nu"&&(o.textContent=h),re.forEach(g),b=U(q),m&&m.l(q),d=U(q),oe(f.$$.fragment,q),c=U(q),u=T(q,"DIV",{class:!0,"aria-live":!0});var he=L(u);Q.l(he),he.forEach(g),q.forEach(g),this.h()},h(){p(o,"type","submit"),p(o,"class","sr-only"),p(r,"class","mb-6"),p(u,"class","space-y-4"),p(u,"aria-live","polite"),p(t,"class","bg-opacity-95 rounded-lg shadow-lg p-6")},m(A,q){ae(e,A,q),I(A,l,q),I(A,t,q),y(t,r),ae(i,r,null),y(r,a),y(r,o),y(t,b),~_&&W[_].m(t,null),y(t,d),ae(f,t,null),y(t,c),y(t,u),Q.m(u,null),E=!0,N||(O=He(r,"submit",s[14]),N=!0)},p(A,q){const re={};q[1]&33554432&&(re.$$scope={dirty:q,ctx:A}),e.$set(re);const he={};!n&&q[0]&1&&(n=!0,he.value=A[0],wt(()=>n=!1)),i.$set(he);let me=_;_=te(A),_===me?~_&&W[_].p(A,q):(m&&(ue(),M(W[me],1,1,()=>{W[me]=null}),de()),~_?(m=W[_],m?m.p(A,q):(m=W[_]=v[_](A),m.c()),D(m,1),m.m(t,d)):m=null),$===($=le(A,q))&&Q?Q.p(A,q):(Q.d(1),Q=$(A),Q&&(Q.c(),Q.m(u,null)))},i(A){E||(D(e.$$.fragment,A),D(i.$$.fragment,A),D(m),D(f.$$.fragment,A),E=!0)},o(A){M(e.$$.fragment,A),M(i.$$.fragment,A),M(m),M(f.$$.fragment,A),E=!1},d(A){A&&(g(l),g(t)),ce(e,A),ce(i),~_&&W[_].d(),ce(f),Q.d(),N=!1,O()}}}function Hl(s){let e,l,t,r;return t=new Ut({props:{class:"bg-opacity-90",$$slots:{default:[Ul]},$$scope:{ctx:s}}}),{c(){e=P("div"),l=P("div"),ie(t.$$.fragment),this.h()},l(i){e=T(i,"DIV",{class:!0});var n=L(e);l=T(n,"DIV",{class:!0});var a=L(l);oe(t.$$.fragment,a),a.forEach(g),n.forEach(g),this.h()},h(){p(l,"class","w-full lg:w-2/3"),p(e,"class","flex justify-center p-6 lg:py-10 bg-change dark:bg-dark shifting")},m(i,n){I(i,e,n),y(e,l),ae(t,l,null),r=!0},p(i,n){const a={};n[0]&127|n[1]&33554432&&(a.$$scope={dirty:n,ctx:i}),t.$set(a)},i(i){r||(D(t.$$.fragment,i),r=!0)},o(i){M(t.$$.fragment,i),r=!1},d(i){i&&g(e),ce(t)}}}function yt(s,e){if(!s||!e)return!1;const l=e.trim().toLowerCase();return s.toLowerCase().includes(l)}function Ql(s,e,l){let t=0;if(s.toLowerCase()===e.toLowerCase())t+=100;else if(s.toLowerCase().includes(e.toLowerCase()))t+=70;else{const r=e.toLowerCase().split(/\s+/),i=s.toLowerCase().split(/\s+/);for(const n of r)if(!(n.length<3)){for(const a of i)if(a.includes(n)||n.includes(a)){t+=20;break}}}switch(l){case"subclass":t+=15;break;case"parent class":t+=10;break;case"made of":case"color":case"has part":t+=25;break;case"used for":t+=20;break;case"also known as":t+=30;break;default:t+=5}return s.length<15&&(t+=10),t}function Wl(s,e,l){let t="",r=[],i=!1,n=!1,a,o,h,b={},_=new Set,m=!1,d=!0,f=!1,c=[],u=[],C=!1,w=[];const E=[{key:"material",label:"Material"},{key:"writtenText",label:"Written Text"},{key:"color",label:"Color"},{key:"shape",label:"Shape"},{key:"location",label:"Location"},{key:"hardness",label:"Hardness"},{key:"timePeriod",label:"Time Period"},{key:"smell",label:"Smell"},{key:"texture",label:"Texture"},{key:"originOfAcquisition",label:"Origin"},{key:"pattern",label:"Pattern"},{key:"print",label:"Print"},{key:"functionality",label:"Functionality"},{key:"brand",label:"Brand"},{key:"markings",label:"Markings"}];Dt(()=>{l(17,m=!0);const S=new URLSearchParams(window.location.search).get("q");S&&S.trim().length>=3?(l(0,t=S),l(4,i=!0),setTimeout(()=>{l(18,d=!1)},0)):l(18,d=!1)}),Ot(()=>{a&&clearTimeout(a),o&&clearTimeout(o),h&&clearTimeout(h)});function N(k){if(!k)return!1;if(yt(k,t))return!0;for(const S of u)if(yt(k,S.label))return!0;return!1}async function O(k){if(!k||k.length<3)return[];try{l(1,n=!0);const S=await fetch(`https://www.wikidata.org/w/api.php?action=wbsearchentities&search=${encodeURIComponent(k)}&language=en&format=json&origin=*&limit=3`);if(!S.ok)throw new Error(`Wikidata search failed: ${S.status}`);const R=await S.json();if(!R.search||!R.search.length)return[];const pe=R.search.slice(0,3);console.log("Top Wikidata entities found:",pe.map(H=>`${H.id} (${H.label})`));const G=new Map;await Promise.all(pe.map(async H=>{const ke=`
                    SELECT DISTINCT ?item ?itemLabel ?relation WHERE {
                    {
                        # Parent classes (instance of)
                        wd:${H.id} wdt:P31 ?item .
                        BIND("parent class" AS ?relation)
                    } UNION {
                        # Subclasses
                        ?item wdt:P31 wd:${H.id} .
                        BIND("subclass" AS ?relation)
                    } UNION {
                        # Related concepts through subclass hierarchy
                        wd:${H.id} wdt:P279 ?item .
                        BIND("broader concept" AS ?relation)
                    } UNION {
                        # Parts and components
                        wd:${H.id} wdt:P527 ?item .
                        BIND("has part" AS ?relation)
                    } UNION {
                        # What it's part of
                        wd:${H.id} wdt:P361 ?item .
                        BIND("part of" AS ?relation)
                    } UNION {
                        # Material composition
                        wd:${H.id} wdt:P186 ?item .
                        BIND("made of" AS ?relation)
                    } UNION {
                        # Object's color
                        wd:${H.id} wdt:P462 ?item .
                        BIND("color" AS ?relation)
                    } UNION {
                        # Used for
                        wd:${H.id} wdt:P366 ?item .
                        BIND("used for" AS ?relation)
                    }
                    SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }
                    }
                    LIMIT 12
                `,Y=`https://query.wikidata.org/sparql?query=${encodeURIComponent(ke)}&format=json`,ee=new AbortController,be=setTimeout(()=>ee.abort(),5e3);try{const ne=await fetch(Y,{signal:ee.signal});if(clearTimeout(be),!ne.ok)throw new Error(`SPARQL query failed: ${ne.status}`);const qe=await ne.json();if(!qe.results||!qe.results.bindings)return;qe.results.bindings.filter(_e=>_e.item&&_e.itemLabel&&_e.relation).forEach(_e=>{const Be=_e.item.value.split("/").pop(),Ve=_e.itemLabel.value,Fe=_e.relation.value;Ve.length>50||G.has(Be)||G.set(Be,{id:Be,label:Ve,relation:Fe,score:Ql(Ve,k,Fe),sourceEntity:H.id})})}catch(ne){ne.name==="AbortError"&&console.error("SPARQL query timed out")}}));const se=Array.from(G.values()).sort((H,ke)=>ke.score-H.score).slice(0,10);return console.log("Found semantic expansions:",se),se}catch(S){return console.error("Error expanding search terms:",S),[]}finally{l(1,n=!1)}}function B(){if(u.length===0)return t.trim();const k=u.map(S=>S.label);return`${t.trim()},${k.join(",")}`}async function j(){if(!f){a&&clearTimeout(a),l(19,f=!0);try{if(!t||t.trim().length<3){l(3,r=[]),l(4,i=!1);return}l(4,i=!0);const k=t.trim(),S=B();console.log("Searching with expanded query:",S);try{const R=await fetch(`${Qt}/api/posts/searchForPosts?q=${encodeURIComponent(S)}`);if(!R.ok)throw new Error(`Search request failed: ${R.status}`);if(k===t.trim()){const pe=await R.json();l(3,r=pe.content||[]);const G=new Set;r.forEach(se=>{se.tags&&Array.isArray(se.tags)&&se.tags.length>0&&se.tags.forEach(H=>{H&&!_.has(H)&&G.add(H)})}),G.size>0&&await $(Array.from(G)),console.log("Search results:",r)}}catch(R){console.error("Error searching posts:",R),l(3,r=[])}}finally{l(4,i=!1),l(19,f=!1)}}}async function v(){if(n)return;o&&clearTimeout(o);const k=t.trim();l(1,n=!0),o=setTimeout(async()=>{try{if(!k||k.length<3||k!==t.trim()){c=[],te(),l(5,C=w.length>0);return}const S=await O(k);k===t.trim()&&(c=S,te(),l(5,C=w.length>0))}catch(S){console.error("Error in semantic search:",S)}finally{l(1,n=!1)}},500)}function W(k){u.findIndex(R=>R.id===k.id)!==-1?l(2,u=u.filter(R=>R.id!==k.id)):l(2,u=[...u,k]),te(),setTimeout(()=>{j()},0)}function te(){const k=[...c].filter(S=>!S.label.match(/^Q\d+$/));u.forEach(S=>{!k.some(R=>R.id===S.id)&&!S.label.match(/^Q\d+$/)&&k.push({...S,fromPreviousSearch:!0})}),JSON.stringify(w)!==JSON.stringify(k)&&l(6,w=k)}function le(k){return u.some(S=>S.id===k.id)}async function $(k){if(!(!k||!k.length))try{k.forEach(R=>_.add(R));const S=20;for(let R=0;R<k.length;R+=S){const G=k.slice(R,R+S).filter(Y=>Y&&typeof Y=="string");if(G.length===0)continue;const se=G.join("|"),H=new AbortController,ke=setTimeout(()=>H.abort(),5e3);try{const Y=await fetch(`https://www.wikidata.org/w/api.php?action=wbgetentities&ids=${se}&props=labels&languages=en&format=json&origin=*`,{signal:H.signal});if(clearTimeout(ke),!Y.ok)throw new Error(`Failed to fetch tag labels: ${Y.status}`);const ee=await Y.json();ee.entities&&Object.keys(ee.entities).forEach(be=>{const ne=ee.entities[be];ne.labels&&ne.labels.en?b[be]=ne.labels.en.value:b[be]=be})}catch(Y){Y.name==="AbortError"?console.error("Tag label fetch timed out"):console.error(`Error fetching batch of tag labels: ${Y.message}`),G.forEach(ee=>{b[ee]||(b[ee]=ee)})}}}catch(S){console.error("Error fetching tag labels:",S)}}let Q=null;function A(){let k=[t.trim()];if(u.forEach(R=>{k.push(R.label)}),k=k.filter(R=>R&&R.trim().length>0).map(R=>R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),k.length===0){Q=null;return}const S=k.join("|");Q=new RegExp(`(${S})`,"gi")}function q(k){return!k||!Q?k:k.replace(Q,"<mark>$1</mark>")}function re(k){return b[k]||k}function he(k){k.preventDefault(),!f&&!n&&t.trim().length>=3&&(j(),v())}let me="",Me="";function St(k){t=k,l(0,t)}const Pt=(k,S)=>S.relation===k&&!S.label.match(/^Q\d+$/),Tt=k=>W(k),At=()=>{l(2,u=[]),j()};return s.$$.update=()=>{if(s.$$.dirty[0]&1867779)if(t&&t.trim().length>=3&&!d){const k=t.trim();k!==me&&!f&&!n&&(l(20,me=k),clearTimeout(a),l(15,a=setTimeout(()=>{j(),t.trim()===k&&v()},300)))}else(!t||t.trim().length<3)&&(f||(l(3,r=[]),l(4,i=!1)));if(s.$$.dirty[0]&5&&(t||u.length>0?A():Q=null),s.$$.dirty[0]&2555905&&m&&typeof window<"u"&&!d){const k=t.trim();k!==Me&&(l(21,Me=k),clearTimeout(h),l(16,h=setTimeout(()=>{try{const S=new URL(window.location.href);k.length>=3?S.searchParams.set("q",k):S.searchParams.delete("q"),window.history.replaceState({},"",S.toString())}catch(S){console.error("Error updating URL:",S)}},500)))}},[t,n,u,r,i,C,w,E,N,j,W,le,q,re,he,a,h,m,d,f,me,Me,St,Pt,Tt,At]}class $l extends Oe{constructor(e){super(),Re(this,e,Wl,Hl,Pe,{},null,[-1,-1])}}export{$l as component};
