import{s as ct,e as y,c as w,b as j,f as c,l as m,i as F,h as f,m as pt,p as mt,k as ht,D as gt,a as A,E as xe,g as C,t as oe,d as ue,r as ye,n as Fe,q as le,u as ie,j as Te,F as Qe,G as Re}from"../chunks/DhMr5c2G.js";import{S as bt,i as _t,c as K,a as H,m as J,t as I,b as M,d as Q,g as vt,f as yt,e as re}from"../chunks/D_SvASXj.js";import{C as wt,a as $t}from"../chunks/DtBTuCuf.js";import{O as kt,Q as Ot,M as Pt}from"../chunks/vtNuVVIe.js";import{g as Ze}from"../chunks/F-ohFSWW.js";import{a as jt}from"../chunks/OLZfEaQC.js";import{T as Ge,M as At}from"../chunks/C0vSs4Ow.js";import{g as ve}from"../chunks/RSIJn0f_.js";import{p as Ct}from"../chunks/BxIVeE_E.js";import{f as St}from"../chunks/CMfn5VrM.js";import{B as We}from"../chunks/BNST9Elv.js";function zt({params:t}){return{id:t.id}}const Wt=Object.freeze(Object.defineProperty({__proto__:null,load:zt},Symbol.toStringTag,{value:"Module"}));function Et(t){let e,s,n="Update the details about your mystery object";return{c(){e=oe(`Edit your post\r
                `),s=y("small"),s.textContent=n,this.h()},l(a){e=ue(a,`Edit your post\r
                `),s=w(a,"SMALL",{class:!0,"data-svelte-h":!0}),ye(s)!=="svelte-p1a2lj"&&(s.textContent=n),this.h()},h(){m(s,"class","block text-xs sm:text-sm mt-1 sm:mt-2 font-semibold opacity-80")},m(a,i){F(a,e,i),F(a,s,i)},p:Fe,d(a){a&&(c(e),c(s))}}}function Ft(t){let e,s,n,a,i="Title*",_,p,g,$,u,h,k,x="Description*",ge,L,O,q,R,N,de,D,Oe,Pe,je,U,X,fe,ze="Tags",Ae,G,be=t[2].length+"",we,Ce,o,b,l,_e,W,T,ee,P="Object Parts",V,v,Be="You can add, edit, or remove parts of your mystery object.",De,Z,Le,Ve,Y,qe,Ie,Me,ce,te,Ye,se,Se,S=t[10].auth&&et(t);function at(r){t[20](r)}let Ke={id:"title",class:"w-full p-2 border rounded dark:border-gray-600 h-auto text-base",placeholder:"Post title"};t[1]!==void 0&&(Ke.value=t[1]),p=new Ge({props:Ke}),le.push(()=>re(p,"value",at));let z=t[10].title&&tt(t);function nt(r){t[21](r)}let He={id:"description",class:"w-full p-2 mb-4 border rounded dark:border-gray-600 h-32",placeholder:"Post description and any additional context"};t[4]!==void 0&&(He.value=t[4]),L=new Ge({props:He}),le.push(()=>re(L,"value",nt));let E=t[10].description&&st(t);function lt(r){t[22](r)}function it(r){t[23](r)}let Ne={};t[11]!==void 0&&(Ne.attributeValues=t[11]),t[12]!==void 0&&(Ne.activeAttributes=t[12]),D=new kt({props:Ne}),le.push(()=>re(D,"attributeValues",lt)),le.push(()=>re(D,"activeAttributes",it)),D.$on("update",t[14]),D.$on("valuechange",t[15]);function rt(r){t[24](r)}function ot(r){t[25](r)}let Ue={};t[2]!==void 0&&(Ue.tags=t[2]),t[3]!==void 0&&(Ue.labels=t[3]),b=new Ot({props:Ue}),le.push(()=>re(b,"tags",rt)),le.push(()=>re(b,"labels",ot));function ut(r){t[26](r)}let Je={mysteryObjectId:t[6]};t[5]!==void 0&&(Je.subParts=t[5]),Z=new Pt({props:Je}),le.push(()=>re(Z,"subParts",ut)),Z.$on("update",t[16]);function dt(r){t[27](r)}function ft(r){t[28](r)}let Xe={};return t[0]!==void 0&&(Xe.mediaFiles=t[0]),t[10]!==void 0&&(Xe.errors=t[10]),Y=new At({props:Xe}),le.push(()=>re(Y,"mediaFiles",dt)),le.push(()=>re(Y,"errors",ft)),Y.$on("update",t[13]),te=new We({props:{variant:"outline",size:"icon",class:"p-2 border rounded transition-all hover:bg-neutral-200 dark:hover:bg-neutral-700",$$slots:{default:[Tt]},$$scope:{ctx:t}}}),te.$on("click",t[29]),se=new We({props:{variant:"outline",size:"icon",class:"p-2 border rounded transition-all hover:bg-rose-900 hover:text-white flex justify-center items-center gap-2",disabled:t[9],$$slots:{default:[Vt]},$$scope:{ctx:t}}}),se.$on("click",t[17]),{c(){e=y("div"),S&&S.c(),s=A(),n=y("div"),a=y("label"),a.textContent=i,_=A(),K(p.$$.fragment),$=A(),z&&z.c(),u=A(),h=y("div"),k=y("label"),k.textContent=x,ge=A(),K(L.$$.fragment),q=A(),E&&E.c(),R=A(),N=y("div"),de=y("div"),K(D.$$.fragment),je=A(),U=y("div"),X=y("label"),fe=y("span"),fe.textContent=ze,Ae=A(),G=y("span"),we=oe(be),Ce=oe(" added"),o=A(),K(b.$$.fragment),W=A(),T=y("div"),ee=y("h3"),ee.textContent=P,V=A(),v=y("p"),v.textContent=Be,De=A(),K(Z.$$.fragment),Ve=A(),K(Y.$$.fragment),Me=A(),ce=y("div"),K(te.$$.fragment),Ye=A(),K(se.$$.fragment),this.h()},l(r){e=w(r,"DIV",{class:!0});var d=j(e);S&&S.l(d),s=C(d),n=w(d,"DIV",{class:!0});var ae=j(n);a=w(ae,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ye(a)!=="svelte-1yfolbh"&&(a.textContent=i),_=C(ae),H(p.$$.fragment,ae),$=C(ae),z&&z.l(ae),ae.forEach(c),u=C(d),h=w(d,"DIV",{class:!0});var ne=j(h);k=w(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ye(k)!=="svelte-1hpburp"&&(k.textContent=x),ge=C(ne),H(L.$$.fragment,ne),q=C(ne),E&&E.l(ne),ne.forEach(c),R=C(d),N=w(d,"DIV",{class:!0});var pe=j(N);de=w(pe,"DIV",{class:!0});var $e=j(de);H(D.$$.fragment,$e),$e.forEach(c),je=C(pe),U=w(pe,"DIV",{class:!0});var me=j(U);X=w(me,"LABEL",{class:!0});var he=j(X);fe=w(he,"SPAN",{"data-svelte-h":!0}),ye(fe)!=="svelte-fsa5fj"&&(fe.textContent=ze),Ae=C(he),G=w(he,"SPAN",{class:!0});var ke=j(G);we=ue(ke,be),Ce=ue(ke," added"),ke.forEach(c),he.forEach(c),o=C(me),H(b.$$.fragment,me),me.forEach(c),pe.forEach(c),W=C(d),T=w(d,"DIV",{class:!0});var B=j(T);ee=w(B,"H3",{class:!0,"data-svelte-h":!0}),ye(ee)!=="svelte-3tzbij"&&(ee.textContent=P),V=C(B),v=w(B,"P",{class:!0,"data-svelte-h":!0}),ye(v)!=="svelte-xiuxil"&&(v.textContent=Be),De=C(B),H(Z.$$.fragment,B),B.forEach(c),Ve=C(d),H(Y.$$.fragment,d),Me=C(d),ce=w(d,"DIV",{class:!0});var Ee=j(ce);H(te.$$.fragment,Ee),Ye=C(Ee),H(se.$$.fragment,Ee),Ee.forEach(c),d.forEach(c),this.h()},h(){m(a,"for","title"),m(a,"class","block text-sm font-medium mb-1.5"),m(n,"class","mb-5"),m(k,"for","description"),m(k,"class","block text-sm font-medium mb-1.5"),m(h,"class","mb-5"),m(de,"class","w-full lg:w-1/2"),m(G,"class","ml-2 px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-xs rounded-full"),m(X,"class","lg:block text-sm font-medium mb-1.5 flex items-center"),m(U,"class","w-full lg:w-1/2 mb-5"),m(N,"class","flex flex-col lg:flex-row lg:gap-6"),m(ee,"class","block text-sm font-medium mb-3"),m(v,"class","text-sm text-neutral-500 mb-4"),m(T,"class","mb-5"),m(ce,"class","flex flex-col sm:flex-row gap-3 justify-end"),m(e,"class","bg-opacity-95 rounded-lg shadow-lg p-4 sm:p-6")},m(r,d){F(r,e,d),S&&S.m(e,null),f(e,s),f(e,n),f(n,a),f(n,_),J(p,n,null),f(n,$),z&&z.m(n,null),f(e,u),f(e,h),f(h,k),f(h,ge),J(L,h,null),f(h,q),E&&E.m(h,null),f(e,R),f(e,N),f(N,de),J(D,de,null),f(N,je),f(N,U),f(U,X),f(X,fe),f(X,Ae),f(X,G),f(G,we),f(G,Ce),f(U,o),J(b,U,null),f(e,W),f(e,T),f(T,ee),f(T,V),f(T,v),f(T,De),J(Z,T,null),f(e,Ve),J(Y,e,null),f(e,Me),f(e,ce),J(te,ce,null),f(ce,Ye),J(se,ce,null),Se=!0},p(r,d){r[10].auth?S?S.p(r,d):(S=et(r),S.c(),S.m(e,s)):S&&(S.d(1),S=null);const ae={};!g&&d[0]&2&&(g=!0,ae.value=r[1],ie(()=>g=!1)),p.$set(ae),r[10].title?z?z.p(r,d):(z=tt(r),z.c(),z.m(n,null)):z&&(z.d(1),z=null);const ne={};!O&&d[0]&16&&(O=!0,ne.value=r[4],ie(()=>O=!1)),L.$set(ne),r[10].description?E?E.p(r,d):(E=st(r),E.c(),E.m(h,null)):E&&(E.d(1),E=null);const pe={};!Oe&&d[0]&2048&&(Oe=!0,pe.attributeValues=r[11],ie(()=>Oe=!1)),!Pe&&d[0]&4096&&(Pe=!0,pe.activeAttributes=r[12],ie(()=>Pe=!1)),D.$set(pe),(!Se||d[0]&4)&&be!==(be=r[2].length+"")&&Te(we,be);const $e={};!l&&d[0]&4&&(l=!0,$e.tags=r[2],ie(()=>l=!1)),!_e&&d[0]&8&&(_e=!0,$e.labels=r[3],ie(()=>_e=!1)),b.$set($e);const me={};d[0]&64&&(me.mysteryObjectId=r[6]),!Le&&d[0]&32&&(Le=!0,me.subParts=r[5],ie(()=>Le=!1)),Z.$set(me);const he={};!qe&&d[0]&1&&(qe=!0,he.mediaFiles=r[0],ie(()=>qe=!1)),!Ie&&d[0]&1024&&(Ie=!0,he.errors=r[10],ie(()=>Ie=!1)),Y.$set(he);const ke={};d[1]&2&&(ke.$$scope={dirty:d,ctx:r}),te.$set(ke);const B={};d[0]&512&&(B.disabled=r[9]),d[0]&512|d[1]&2&&(B.$$scope={dirty:d,ctx:r}),se.$set(B)},i(r){Se||(I(p.$$.fragment,r),I(L.$$.fragment,r),I(D.$$.fragment,r),I(b.$$.fragment,r),I(Z.$$.fragment,r),I(Y.$$.fragment,r),I(te.$$.fragment,r),I(se.$$.fragment,r),Se=!0)},o(r){M(p.$$.fragment,r),M(L.$$.fragment,r),M(D.$$.fragment,r),M(b.$$.fragment,r),M(Z.$$.fragment,r),M(Y.$$.fragment,r),M(te.$$.fragment,r),M(se.$$.fragment,r),Se=!1},d(r){r&&c(e),S&&S.d(),Q(p),z&&z.d(),Q(L),E&&E.d(),Q(D),Q(b),Q(Z),Q(Y),Q(te),Q(se)}}}function xt(t){let e,s='<div class="animate-spin rounded-full h-12 w-12 border-b-2 border-rose-900"></div>';return{c(){e=y("div"),e.innerHTML=s,this.h()},l(n){e=w(n,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-1g9ah59"&&(e.innerHTML=s),this.h()},h(){m(e,"class","flex justify-center items-center py-16")},m(n,a){F(n,e,a)},p:Fe,i:Fe,o:Fe,d(n){n&&c(e)}}}function et(t){let e,s=t[10].auth+"",n;return{c(){e=y("div"),n=oe(s),this.h()},l(a){e=w(a,"DIV",{class:!0});var i=j(e);n=ue(i,s),i.forEach(c),this.h()},h(){m(e,"class","bg-red-100 text-red-800 p-4 rounded-md mb-6")},m(a,i){F(a,e,i),f(e,n)},p(a,i){i[0]&1024&&s!==(s=a[10].auth+"")&&Te(n,s)},d(a){a&&c(e)}}}function tt(t){let e,s=t[10].title+"",n;return{c(){e=y("p"),n=oe(s),this.h()},l(a){e=w(a,"P",{class:!0});var i=j(e);n=ue(i,s),i.forEach(c),this.h()},h(){m(e,"class","text-red-500 text-sm mt-1")},m(a,i){F(a,e,i),f(e,n)},p(a,i){i[0]&1024&&s!==(s=a[10].title+"")&&Te(n,s)},d(a){a&&c(e)}}}function st(t){let e,s=t[10].description+"",n;return{c(){e=y("p"),n=oe(s),this.h()},l(a){e=w(a,"P",{class:!0});var i=j(e);n=ue(i,s),i.forEach(c),this.h()},h(){m(e,"class","text-red-500 text-sm mt-1")},m(a,i){F(a,e,i),f(e,n)},p(a,i){i[0]&1024&&s!==(s=a[10].description+"")&&Te(n,s)},d(a){a&&c(e)}}}function Tt(t){let e;return{c(){e=oe("Cancel")},l(s){e=ue(s,"Cancel")},m(s,n){F(s,e,n)},d(s){s&&c(e)}}}function Dt(t){let e,s,n;return{c(){e=Qe("svg"),s=Qe("path"),n=oe(`\r
                                Save Changes`),this.h()},l(a){e=Re(a,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var i=j(e);s=Re(i,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),j(s).forEach(c),i.forEach(c),n=ue(a,`\r
                                Save Changes`),this.h()},h(){m(s,"fill-rule","evenodd"),m(s,"d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"),m(s,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"class","h-4 w-4 mr-1"),m(e,"viewBox","0 0 20 20"),m(e,"fill","currentColor")},m(a,i){F(a,e,i),f(e,s),F(a,n,i)},d(a){a&&(c(e),c(n))}}}function Lt(t){let e,s;return{c(){e=y("span"),s=oe(`\r
                                Saving Changes...`),this.h()},l(n){e=w(n,"SPAN",{class:!0}),j(e).forEach(c),s=ue(n,`\r
                                Saving Changes...`),this.h()},h(){m(e,"class","inline-block h-4 w-4 border-2 border-current/30 border-t-current rounded-full animate-spin mr-2")},m(n,a){F(n,e,a),F(n,s,a)},d(n){n&&(c(e),c(s))}}}function Vt(t){let e;function s(i,_){return i[9]?Lt:Dt}let n=s(t),a=n(t);return{c(){a.c(),e=xe()},l(i){a.l(i),e=xe()},m(i,_){a.m(i,_),F(i,e,_)},p(i,_){n!==(n=s(i))&&(a.d(1),a=n(i),a&&(a.c(),a.m(e.parentNode,e)))},d(i){i&&c(e),a.d(i)}}}function qt(t){let e,s,n,a,i,_;e=new $t({props:{class:"p-3 sm:p-4 text-xl sm:text-2xl mt-4 sm:mt-6 text-center",$$slots:{default:[Et]},$$scope:{ctx:t}}});const p=[xt,Ft],g=[];function $(u,h){return u[8]?0:1}return n=$(t),a=g[n]=p[n](t),{c(){K(e.$$.fragment),s=A(),a.c(),i=xe()},l(u){H(e.$$.fragment,u),s=C(u),a.l(u),i=xe()},m(u,h){J(e,u,h),F(u,s,h),g[n].m(u,h),F(u,i,h),_=!0},p(u,h){const k={};h[1]&2&&(k.$$scope={dirty:h,ctx:u}),e.$set(k);let x=n;n=$(u),n===x?g[n].p(u,h):(vt(),M(g[x],1,1,()=>{g[x]=null}),yt(),a=g[n],a?a.p(u,h):(a=g[n]=p[n](u),a.c()),I(a,1),a.m(i.parentNode,i))},i(u){_||(I(e.$$.fragment,u),I(a),_=!0)},o(u){M(e.$$.fragment,u),M(a),_=!1},d(u){u&&(c(s),c(i)),Q(e,u),g[n].d(u)}}}function It(t){let e,s,n,a,i,_;return n=new wt({props:{class:"bg-opacity-90 shadow-xl",$$slots:{default:[qt]},$$scope:{ctx:t}}}),{c(){e=y("div"),s=y("form"),K(n.$$.fragment),this.h()},l(p){e=w(p,"DIV",{class:!0});var g=j(e);s=w(g,"FORM",{class:!0});var $=j(s);H(n.$$.fragment,$),$.forEach(c),g.forEach(c),this.h()},h(){m(s,"class","w-full lg:w-2/3"),m(e,"class","flex justify-center p-3 sm:p-6 lg:py-10 bg-change dark:bg-dark shifting")},m(p,g){F(p,e,g),f(e,s),J(n,s,null),a=!0,i||(_=pt(s,"submit",mt(t[17])),i=!0)},p(p,g){const $={};g[0]&8191|g[1]&2&&($.$$scope={dirty:g,ctx:p}),n.$set($)},i(p){a||(I(n.$$.fragment,p),a=!0)},o(p){M(n.$$.fragment,p),a=!1},d(p){p&&c(e),Q(n),i=!1,_()}}}function Mt(t){return{id:t.id,description:t.description||"",material:t.material||null,color:t.color||null,shape:t.shape||null,location:t.location||null,smell:t.smell||null,taste:t.taste||null,texture:t.texture||null,functionality:t.functionality||null,markings:t.markings||null,handmade:t.handmade||!1,oneOfAKind:t.oneOfAKind||!1,weight:t.weight?parseFloat(t.weight):null,timePeriod:t.timePeriod||null,writtenText:t.writtenText||null,descriptionOfParts:t.descriptionOfParts||null,hardness:t.hardness||null,value:t.value?parseFloat(t.value):null,originOfAcquisition:t.originOfAcquisition||null,pattern:t.pattern||null,brand:t.brand||null,print:t.print||null,imageLicenses:t.imageLicenses||null,sizeX:t.sizeX?parseFloat(t.sizeX):null,sizeY:t.sizeY?parseFloat(t.sizeY):null,sizeZ:t.sizeZ?parseFloat(t.sizeZ):null,item_condition:t.item_condition||null}}function Yt(t,e,s){let n;ht(t,jt,o=>s(19,n=o));let{data:a}=e,i=[],_="",p=[],g=[],$="",u=[],h=null,k=null,x=null,ge=!0,L=!1,O={title:"",media:"",description:"",auth:""},q={material:"",shape:"",color:"",texture:"",weight:"",smell:"",taste:"",marking:"",functionality:"",period:"",location:"",writtenText:"",descriptionOfParts:"",hardness:"",value:"",originOfAcquisition:"",pattern:"",brand:"",print:"",imageLicenses:"",sizeX:"",sizeY:"",sizeZ:"",itemCondition:"",handmade:!1,oneOfAKind:!1},R=[];gt(async()=>{try{s(8,ge=!0),s(7,x=a.id);const o=await fetch(`https://backend-310608491068.europe-west1.run.app/api/posts/getForPostDetails/${x}`,{headers:ve()});if(!o.ok)throw new Error("Failed to fetch post details");const b=await o.json();if(h=b,b.author!==n){s(10,O.auth="You don't have permission to edit this post",O),Ze(`/thread/${x}`);return}if(s(1,_=b.title||""),s(4,$=b.description||""),Array.isArray(b.tags)&&b.tags.length>0?s(2,p=await St(b.tags)):s(2,p=[]),b.mysteryObject){s(0,i=Ct(b)),s(6,k=b.mysteryObject.id);const l=b.mysteryObject;s(11,q={material:l.material||"",shape:l.shape||"",color:l.color||"",colorHex:l.color&&l.color.startsWith("#")?l.color:"",texture:l.texture||"",weight:l.weight?l.weight.toString():"",smell:l.smell||"",taste:l.taste||"",marking:l.markings||"",functionality:l.functionality||"",period:l.timePeriod||"",location:l.location||"",writtenText:l.writtenText||"",descriptionOfParts:l.descriptionOfParts||"",hardness:l.hardness||"",value:l.value?l.value.toString():"",originOfAcquisition:l.originOfAcquisition||"",pattern:l.pattern||"",brand:l.brand||"",print:l.print||"",imageLicenses:l.imageLicenses||"",sizeX:l.sizeX?l.sizeX.toString():"",sizeY:l.sizeY?l.sizeY.toString():"",sizeZ:l.sizeZ?l.sizeZ.toString():"",itemCondition:l.item_condition||"",handmade:l.handmade||!1,oneOfAKind:l.oneOfAKind||!1}),s(12,R=Object.keys(q).filter(_e=>{const W=q[_e];return W!==""&&W!==null&&W!==void 0})),l.subParts&&Array.isArray(l.subParts)&&s(5,u=l.subParts)}}catch(o){console.error("Error loading post for editing:",o),s(10,O.auth="Error loading post data",O)}finally{s(8,ge=!1)}});function N(o){s(0,i=o.detail.mediaFiles)}function de(o){s(12,R=o.detail.activeAttributes)}function D(o){s(11,q=o.detail.attributeValues)}function Oe(o){s(5,u=o.detail.subParts)}async function Pe(){var b;s(10,O={title:"",media:"",description:"",auth:""});let o=!1;if(_.trim()||(s(10,O.title="Title is required",O),o=!0),i.length===0&&(s(10,O.media="At least one media file is required",O),o=!0),$.trim()||(s(10,O.description="Description is required",O),o=!0),!o){s(9,L=!0);try{const l=JSON.parse(JSON.stringify(q)),_e={id:k,description:$,material:l.material||null,color:l.colorHex||l.color||null,shape:l.shape||null,location:l.location||null,smell:l.smell||null,taste:l.taste||l.smell||null,texture:l.texture||null,functionality:l.functionality||null,markings:l.marking||null,handmade:l.handmade||!1,oneOfAKind:l.oneOfAKind||!1,weight:parseFloat(l.weight)||null,timePeriod:l.period||null,writtenText:l.writtenText||null,descriptionOfParts:l.descriptionOfParts||null,hardness:l.hardness||null,value:parseFloat(l.value)||null,originOfAcquisition:l.originOfAcquisition||null,pattern:l.pattern||null,brand:l.brand||null,print:l.print||null,imageLicenses:l.imageLicenses||null,sizeX:parseFloat(l.sizeX)||null,sizeY:parseFloat(l.sizeY)||null,sizeZ:parseFloat(l.sizeZ)||null,item_condition:l.itemCondition||null},W={id:x,title:_,content:$,tags:p.map(P=>P.id),mysteryObject:_e},T=await fetch("https://backend-310608491068.europe-west1.run.app/api/posts/update",{method:"PUT",headers:{"Content-Type":"application/json",...ve()},body:JSON.stringify(W)});if(!T.ok){const P=await T.text();throw new Error(`Failed to update post: ${T.status} - ${P}`)}const ee=await T.json();if(console.log("Post updated successfully:",ee),i.length>0&&i[0].file){const P=new FormData;P.append("file",i[0].file),await fetch(`https://backend-310608491068.europe-west1.run.app/api/posts/${x}/mysteryObjects/${k}/set-image`,{method:"POST",headers:ve(),body:P})}for(let P=0;P<i.length;P++){const V=i[P];if(!V.file)continue;const v=new FormData;v.append("file",V.file),v.append("type",V.type||"image"),await fetch(`https://backend-310608491068.europe-west1.run.app/api/mysteryObjects/${k}/upload-media`,{method:"POST",headers:ve(),body:v})}if(u.length>0){for(let P=0;P<u.length;P++){const V=u[P],v=Mt(V);V.id?await fetch(`https://backend-310608491068.europe-west1.run.app/api/mysteryObjects/${k}/subParts/${V.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...ve()},body:JSON.stringify(v)}):await fetch(`https://backend-310608491068.europe-west1.run.app/api/mysteryObjects/${k}/subParts`,{method:"POST",headers:{"Content-Type":"application/json",...ve()},body:JSON.stringify(v)})}if((b=h==null?void 0:h.mysteryObject)!=null&&b.subParts){const P=new Set(h.mysteryObject.subParts.map(v=>v.id)),V=new Set(u.filter(v=>v.id).map(v=>v.id));for(const v of P)V.has(v)||await fetch(`https://backend-310608491068.europe-west1.run.app/api/mysteryObjects/${k}/subParts/${v}`,{method:"DELETE",headers:ve()})}}Ze(`/thread/${x}`)}catch(l){console.error("Error updating post:",l),s(10,O.auth=`Failed to update post: ${l.message}`,O)}finally{s(9,L=!1)}}}function je(o){_=o,s(1,_)}function U(o){$=o,s(4,$)}function X(o){q=o,s(11,q)}function fe(o){R=o,s(12,R)}function ze(o){p=o,s(2,p)}function Ae(o){g=o,s(3,g)}function G(o){u=o,s(5,u)}function be(o){i=o,s(0,i)}function we(o){O=o,s(10,O)}const Ce=()=>Ze(`/thread/${x}`);return t.$$set=o=>{"data"in o&&s(18,a=o.data)},t.$$.update=()=>{t.$$.dirty[0]&524288},[i,_,p,g,$,u,k,x,ge,L,O,q,R,N,de,D,Oe,Pe,a,n,je,U,X,fe,ze,Ae,G,be,we,Ce]}class es extends bt{constructor(e){super(),_t(this,e,Yt,It,ct,{data:18},null,[-1,-1])}}export{es as component,Wt as universal};
