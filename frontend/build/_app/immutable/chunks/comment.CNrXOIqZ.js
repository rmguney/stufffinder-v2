import{s as fe,e as P,c as R,b as U,f as d,l as w,i as k,a as M,g as A,h as N,t as Y,d as q,j as L,D as ie,E as X,F as ce,G as me,H as x,I as ee}from"./scheduler.CONNQF1V.js";import{S as ue,i as pe,c as j,a as H,m as T,t as g,b as v,d as V,g as W,e as Z,f as de}from"./index.BnMMC023.js";import{a as _e,B as Q,e as te}from"./userStore.C8Faxakg.js";import{C as he,a as ge}from"./card-title.CkskY9-3.js";import{C as $e,a as ve,S as be}from"./card-header.LrTvonhQ.js";import{t as we}from"./threadStore.z8eUMdcT.js";import{T as ke}from"./textarea.BA-fNqlE.js";function re(s,e,r){const t=s.slice();return t[15]=e[r],t}function le(s){let e,r;return{c(){e=x("svg"),r=x("path"),this.h()},l(t){e=ee(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var l=U(e);r=ee(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),U(r).forEach(d),l.forEach(d),this.h()},h(){w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(r,"d","M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"),w(e,"xmlns","http://www.w3.org/2000/svg"),w(e,"fill","none"),w(e,"viewBox","0 0 24 24"),w(e,"stroke-width","2"),w(e,"stroke","currentColor"),w(e,"class","ml-2 size-5 text-teal-800")},m(t,l){k(t,e,l),N(e,r)},d(t){t&&d(e)}}}function Ce(s){let e,r,t,l=s[0]&&le();return{c(){e=Y(s[1]),r=M(),l&&l.c(),t=X()},l(a){e=q(a,s[1]),r=A(a),l&&l.l(a),t=X()},m(a,o){k(a,e,o),k(a,r,o),l&&l.m(a,o),k(a,t,o)},p(a,o){o&2&&L(e,a[1]),a[0]?l||(l=le(),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(a){a&&(d(e),d(r),d(t)),l&&l.d(a)}}}function De(s){let e,r;return e=new ge({props:{class:"w-full flex items-center",$$slots:{default:[Ce]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,l){T(e,t,l),r=!0},p(t,l){const a={};l&262147&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){V(e,t)}}}function ne(s){let e,r;return e=new Q({props:{class:"w-1/4 text-xs py-1 px-2 hover:bg-rose-900",$$slots:{default:[Ie]},$$scope:{ctx:s}}}),e.$on("click",s[12]),{c(){j(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,l){T(e,t,l),r=!0},p(t,l){const a={};l&262145&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){V(e,t)}}}function Ie(s){let e=s[0]?"Unmark":"Mark as Helpful",r;return{c(){r=Y(e)},l(t){r=q(t,e)},m(t,l){k(t,r,l)},p(t,l){l&1&&e!==(e=t[0]?"Unmark":"Mark as Helpful")&&L(r,e)},d(t){t&&d(r)}}}function Se(s){let e=s[7]?"Cancel":"Reply",r;return{c(){r=Y(e)},l(t){r=q(t,e)},m(t,l){k(t,r,l)},p(t,l){l&128&&e!==(e=t[7]?"Cancel":"Reply")&&L(r,e)},d(t){t&&d(r)}}}function se(s){let e,r;return e=new Q({props:{class:"w-1/4 text-xs py-1 px-2 hover:bg-rose-900",$$slots:{default:[Ee]},$$scope:{ctx:s}}}),e.$on("click",s[10]),{c(){j(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,l){T(e,t,l),r=!0},p(t,l){const a={};l&262144&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){V(e,t)}}}function Ee(s){let e;return{c(){e=Y("Submit")},l(r){e=q(r,"Submit")},m(r,t){k(r,e,t)},d(r){r&&d(e)}}}function ae(s){let e,r,t,l;function a(c){s[14](c)}let o={class:"w-full p-2 border rounded-lg text-sm",placeholder:"Write your reply..."};return s[8]!==void 0&&(o.value=s[8]),r=new ke({props:o}),ce.push(()=>de(r,"value",a)),{c(){e=P("div"),j(r.$$.fragment),this.h()},l(c){e=R(c,"DIV",{class:!0});var b=U(e);H(r.$$.fragment,b),b.forEach(d),this.h()},h(){w(e,"class","mt-2")},m(c,b){k(c,e,b),T(r,e,null),l=!0},p(c,b){const C={};!t&&b&256&&(t=!0,C.value=c[8],me(()=>t=!1)),r.$set(C)},i(c){l||(g(r.$$.fragment,c),l=!0)},o(c){v(r.$$.fragment,c),l=!1},d(c){c&&d(e),V(r)}}}function oe(s){let e,r;return e=new Te({props:{commentId:s[15].id,comment:s[15].comment,commentator:s[15].commentator,postedDateComment:s[15].postedDateComment,selected:s[15].selected,threadOwner:s[4],replies:s[15].replies||[]}}),{c(){j(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,l){T(e,t,l),r=!0},p(t,l){const a={};l&32&&(a.commentId=t[15].id),l&32&&(a.comment=t[15].comment),l&32&&(a.commentator=t[15].commentator),l&32&&(a.postedDateComment=t[15].postedDateComment),l&32&&(a.selected=t[15].selected),l&16&&(a.threadOwner=t[4]),l&32&&(a.replies=t[15].replies||[]),e.$set(a)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){V(e,t)}}}function ye(s){let e,r,t,l,a,o=s[11](s[3])+"",c,b,C,B,$,D,I,G,z,F,E,f;C=new be({props:{class:"mt-4"}});let m=s[6]===s[4]&&ne(s);I=new Q({props:{class:"w-1/4 text-xs py-1 px-2 hover:bg-rose-900",$$slots:{default:[Se]},$$scope:{ctx:s}}}),I.$on("click",s[9]);let p=s[7]&&se(s),_=s[7]&&ae(s),S=te(s[5]),u=[];for(let n=0;n<S.length;n+=1)u[n]=oe(re(s,S,n));const y=n=>v(u[n],1,1,()=>{u[n]=null});return{c(){e=P("span"),r=P("a"),t=Y(s[2]),a=Y(`\r
          at `),c=Y(o),b=M(),j(C.$$.fragment),B=M(),$=P("div"),m&&m.c(),D=M(),j(I.$$.fragment),G=M(),p&&p.c(),z=M(),_&&_.c(),F=M(),E=P("div");for(let n=0;n<u.length;n+=1)u[n].c();this.h()},l(n){e=R(n,"SPAN",{});var i=U(e);r=R(i,"A",{href:!0,class:!0});var O=U(r);t=q(O,s[2]),O.forEach(d),a=q(i,`\r
          at `),c=q(i,o),i.forEach(d),b=A(n),H(C.$$.fragment,n),B=A(n),$=R(n,"DIV",{class:!0});var h=U($);m&&m.l(h),D=A(h),H(I.$$.fragment,h),G=A(h),p&&p.l(h),h.forEach(d),z=A(n),_&&_.l(n),F=A(n),E=R(n,"DIV",{class:!0});var J=U(E);for(let K=0;K<u.length;K+=1)u[K].l(J);J.forEach(d),this.h()},h(){w(r,"href",l=`/user/${s[2]}`),w(r,"class","hover:text-rose-900 hover:underline font-bold"),w($,"class","flex flex-row justify-center mt-4 gap-2"),w(E,"class","mt-4 px-4 border-l")},m(n,i){k(n,e,i),N(e,r),N(r,t),N(e,a),N(e,c),k(n,b,i),T(C,n,i),k(n,B,i),k(n,$,i),m&&m.m($,null),N($,D),T(I,$,null),N($,G),p&&p.m($,null),k(n,z,i),_&&_.m(n,i),k(n,F,i),k(n,E,i);for(let O=0;O<u.length;O+=1)u[O]&&u[O].m(E,null);f=!0},p(n,i){(!f||i&4)&&L(t,n[2]),(!f||i&4&&l!==(l=`/user/${n[2]}`))&&w(r,"href",l),(!f||i&8)&&o!==(o=n[11](n[3])+"")&&L(c,o),n[6]===n[4]?m?(m.p(n,i),i&80&&g(m,1)):(m=ne(n),m.c(),g(m,1),m.m($,D)):m&&(W(),v(m,1,1,()=>{m=null}),Z());const O={};if(i&262272&&(O.$$scope={dirty:i,ctx:n}),I.$set(O),n[7]?p?(p.p(n,i),i&128&&g(p,1)):(p=se(n),p.c(),g(p,1),p.m($,null)):p&&(W(),v(p,1,1,()=>{p=null}),Z()),n[7]?_?(_.p(n,i),i&128&&g(_,1)):(_=ae(n),_.c(),g(_,1),_.m(F.parentNode,F)):_&&(W(),v(_,1,1,()=>{_=null}),Z()),i&48){S=te(n[5]);let h;for(h=0;h<S.length;h+=1){const J=re(n,S,h);u[h]?(u[h].p(J,i),g(u[h],1)):(u[h]=oe(J),u[h].c(),g(u[h],1),u[h].m(E,null))}for(W(),h=S.length;h<u.length;h+=1)y(h);Z()}},i(n){if(!f){g(C.$$.fragment,n),g(m),g(I.$$.fragment,n),g(p),g(_);for(let i=0;i<S.length;i+=1)g(u[i]);f=!0}},o(n){v(C.$$.fragment,n),v(m),v(I.$$.fragment,n),v(p),v(_),u=u.filter(Boolean);for(let i=0;i<u.length;i+=1)v(u[i]);f=!1},d(n){n&&(d(e),d(b),d(B),d($),d(z),d(F),d(E)),V(C,n),m&&m.d(),V(I),p&&p.d(),_&&_.d(n),ie(u,n)}}}function Oe(s){let e,r,t,l,a;return r=new $e({props:{$$slots:{default:[De]},$$scope:{ctx:s}}}),l=new ve({props:{class:"flex flex-col w-full px-6",$$slots:{default:[ye]},$$scope:{ctx:s}}}),{c(){e=P("div"),j(r.$$.fragment),t=M(),j(l.$$.fragment),this.h()},l(o){e=R(o,"DIV",{class:!0});var c=U(e);H(r.$$.fragment,c),t=A(c),H(l.$$.fragment,c),c.forEach(d),this.h()},h(){w(e,"class","flex flex-col w-full")},m(o,c){k(o,e,c),T(r,e,null),N(e,t),T(l,e,null),a=!0},p(o,c){const b={};c&262147&&(b.$$scope={dirty:c,ctx:o}),r.$set(b);const C={};c&262653&&(C.$$scope={dirty:c,ctx:o}),l.$set(C)},i(o){a||(g(r.$$.fragment,o),g(l.$$.fragment,o),a=!0)},o(o){v(r.$$.fragment,o),v(l.$$.fragment,o),a=!1},d(o){o&&d(e),V(r),V(l)}}}function je(s){let e,r,t;return r=new he({props:{class:`w-full bg-opacity-90 hover:bg-opacity-100 relative ${s[0]?"border-4 border-teal-600 dark:border-teal-800":""}`,$$slots:{default:[Oe]},$$scope:{ctx:s}}}),{c(){e=P("div"),j(r.$$.fragment),this.h()},l(l){e=R(l,"DIV",{class:!0});var a=U(e);H(r.$$.fragment,a),a.forEach(d),this.h()},h(){w(e,"class","flex w-full py-1")},m(l,a){k(l,e,a),T(r,e,null),t=!0},p(l,[a]){const o={};a&1&&(o.class=`w-full bg-opacity-90 hover:bg-opacity-100 relative ${l[0]?"border-4 border-teal-600 dark:border-teal-800":""}`),a&262655&&(o.$$scope={dirty:a,ctx:l}),r.$set(o)},i(l){t||(g(r.$$.fragment,l),t=!0)},o(l){v(r.$$.fragment,l),t=!1},d(l){l&&d(e),V(r)}}}function He(s,e,r){let{commentId:t}=e,{comment:l}=e,{commentator:a}=e,{postedDateComment:o}=e,{selected:c}=e,{threadOwner:b}=e,{replies:C=[]}=e,B=null,$=!1,D="";const I=()=>{r(7,$=!$)},G=async()=>{if(!D.trim())return;const f=`https://threef.vercel.app/api/comments/${t}/add-reply/`,m={comment:D,commentator:B||"Anonymous"};try{const p=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!p.ok){console.error("Failed to add reply");return}const _=await p.json();we.update(S=>S.map(u=>({...u,comments:u.comments.map(y=>y.id===t?{...y,replies:[...y.replies||[],_]}:{...y,replies:y.replies?y.replies.map(n=>n.id===t?{...n,replies:[...n.replies||[],_]}:n):[]})}))),r(8,D=""),r(7,$=!1)}catch(p){console.error("Error adding reply:",p)}},z=f=>{if(!f)return"";const m=new Date(f),p={hour:"numeric",minute:"numeric",hour12:!1},_=new Intl.DateTimeFormat("en-US",p).format(m),S=m.getDate(),u=m.toLocaleString("en-US",{month:"short"}),y=m.getFullYear();return`${_}, ${S} ${u} ${y}`},F=async()=>{try{const f=await fetch(`https://threef.vercel.app/api/comments/${t}/toggle-selected/`,{method:"PATCH",headers:{"Content-Type":"application/json"}});if(!f.ok){console.error("Failed to toggle helpful status");return}const m=await f.json();r(0,c=m.selected)}catch(f){console.error("Error toggling helpful status:",f)}};function E(f){D=f,r(8,D)}return s.$$set=f=>{"commentId"in f&&r(13,t=f.commentId),"comment"in f&&r(1,l=f.comment),"commentator"in f&&r(2,a=f.commentator),"postedDateComment"in f&&r(3,o=f.postedDateComment),"selected"in f&&r(0,c=f.selected),"threadOwner"in f&&r(4,b=f.threadOwner),"replies"in f&&r(5,C=f.replies)},_e.subscribe(f=>{r(6,B=f)}),[c,l,a,o,b,C,B,$,D,I,G,z,F,t,E]}class Te extends ue{constructor(e){super(),pe(this,e,He,je,fe,{commentId:13,comment:1,commentator:2,postedDateComment:3,selected:0,threadOwner:4,replies:5})}}export{Te as C};
