import{w as u}from"./CTHOJFrz.js";const a=u([]),c=u(!1),d=u(0),l=u(!0),h=20,p=new Map;async function T(){c.set(!0);try{await f(0)}catch(t){console.error("Thread store initialization error:",t)}finally{c.set(!1)}}async function f(t=0){try{c.set(!0);const e=await fetch(`https://backend-310608491068.europe-west1.run.app/api/posts/getForPostList?page=${t}&size=${h}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json(),s=r.content||[];l.set(!r.last),t===0?a.set(s):a.update(n=>[...n,...s]);let o;return a.subscribe(n=>{o=n})(),d.set(t),s}catch(e){throw console.error("Error fetching threads:",e),e}finally{c.set(!1)}}function m(t){a.update(e=>{const r=e.findIndex(o=>o.id==t.id);let s;if(r!==-1){s=[...e];const o=s[r].comments||[];s[r]={...s[r],...t,comments:o},s[r].updatedAt=new Date().toISOString()}else s=[...e,t];return s})}async function y(t,e){try{const r=await fetch(`https://backend-310608491068.europe-west1.run.app/api/posts/${t}/resolve`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw new Error("Failed to resolve post");const s=await r.json();return p.delete(t),a.update(o=>o.map(n=>n.id===t?{...n,solved:!0,resolution:e}:n)),s}catch(r){throw console.error("Error resolving post:",r),r}}async function b(t){try{const e=await fetch(`https://backend-310608491068.europe-west1.run.app/api/posts/${t}/unresolve`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to unresolve post");const r=await e.json();return p.delete(t),a.update(s=>s.map(i=>i.id===t?{...i,solved:!1,resolution:null}:i)),r}catch(e){throw console.error("Error unresolving post:",e),e}}export{T as a,m as b,c as i,y as r,a as t,b as u};
